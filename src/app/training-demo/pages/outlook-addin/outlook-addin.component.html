<div class="outlook-addin-container">
  <!-- Header -->
  <div class="addin-header">
    <div class="header-icon">📧</div>
    <div class="header-content">
      <h1 class="addin-title">Outlook Signature Training</h1>
      <p class="addin-subtitle">Practice & grade your email signature</p>
    </div>
  </div>

  <!-- Office.js Status -->
  <div class="status-indicator" [class.ready]="isOfficeReady" [class.compose]="isComposeMode">
    <div class="status-dot"></div>
    <span class="status-text">
      {{ isOfficeReady ? (isComposeMode ? 'Ready to grade' : 'Open a new message') : 'Loading...' }}
    </span>
  </div>

  <!-- Instructions -->
  <div class="instructions-section" *ngIf="showInstructions">
    <div class="instruction-card">
      <h3>📋 How to use this training:</h3>
      <ol>
        <li>Create a new email message in Outlook</li>
        <li>Build your signature in the message body</li>
        <li>Click "Fetch Email Body" to load your signature</li>
        <li>Click "Grade Now" to get instant feedback</li>
        <li>Review your score and improvement suggestions</li>
      </ol>
    </div>

    <div class="instruction-card">
      <h3>✅ Signature Requirements:</h3>
      <ul>
        <li>Company logo (left side)</li>
        <li>Your name (bold, brand color)</li>
        <li>Job title</li>
        <li>Company name</li>
        <li>Phone number (with tel: link)</li>
        <li>Email address (with mailto: link)</li>
        <li>Website URL (with https: link)</li>
        <li>Professional layout</li>
      </ul>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="action-section" *ngIf="isOfficeReady && isComposeMode">
    <button 
      class="action-btn fetch-btn" 
      (click)="fetchEmailBody()"
      [disabled]="isGrading">
      📥 Fetch Email Body
    </button>
    
    <button 
      class="action-btn grade-btn" 
      (click)="gradeSignature()"
      [disabled]="!emailHtml || isGrading">
      <span *ngIf="isGrading" class="spinner"></span>
      {{ isGrading ? 'Grading...' : '🎯 Grade Now' }}
    </button>
  </div>

  <!-- Email Preview -->
  <div class="email-preview" *ngIf="emailHtml">
    <h3>📧 Email Preview:</h3>
    <div class="preview-content">
      <pre>{{ getEmailPreview() }}</pre>
    </div>
    <button class="copy-btn" (click)="copySignature()">
      📋 Copy Signature
    </button>
  </div>

  <!-- Grading Results -->
  <div class="results-section" *ngIf="showResults && gradingResult">
    <div class="grade-card" [ngClass]="getGradeColorClass(gradingResult.percentage)">
      <div class="grade-header">
        <h3>📊 Signature Grade</h3>
        <div class="grade-score">{{ gradingResult.percentage }}%</div>
        <div class="grade-label">{{ getGradeLabel(gradingResult.percentage) }}</div>
      </div>
      
      <div class="grade-details">
        <div class="score-breakdown">
          <span class="score-text">{{ gradingResult.score }}/{{ gradingResult.maxScore }} requirements met</span>
        </div>
      </div>
    </div>

    <div class="feedback-section">
      <h4>📝 Feedback:</h4>
      <div class="feedback-list">
        <div 
          *ngFor="let feedback of gradingResult.feedback" 
          class="feedback-item"
          [class.positive]="feedback.startsWith('✅')"
          [class.negative]="feedback.startsWith('❌')">
          {{ feedback }}
        </div>
      </div>
    </div>

    <div class="action-buttons">
      <button class="reset-btn" (click)="resetGrading()">
        🔄 Grade Another
      </button>
      <button class="copy-btn" (click)="copySignature()">
        📋 Copy Signature
      </button>
    </div>
  </div>

  <!-- Error States -->
  <div class="error-section" *ngIf="!isOfficeReady">
    <div class="error-card">
      <h3>⚠️ Office.js Not Ready</h3>
      <p>Please wait for the Office add-in to initialize...</p>
    </div>
  </div>

  <div class="error-section" *ngIf="isOfficeReady && !isComposeMode">
    <div class="error-card">
      <h3>📝 No Message Open</h3>
      <p>Please open a new email message to use this training tool.</p>
    </div>
  </div>
</div>
