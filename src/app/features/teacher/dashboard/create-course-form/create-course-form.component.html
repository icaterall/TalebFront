<!-- Create Course Form Modal -->
<div class="create-course-modal" (keydown.escape)="onEscapeKey($event)">
  <div class="modal-backdrop"></div>
  
  <div class="modal-content">
    <!-- Header -->
    <div class="modal-header">
      <h1>{{ 'onb.createCourse.form.title' | translate }}</h1>
      <p>{{ 'onb.createCourse.form.subtitle' | translate }}</p>
      <button class="close-btn" (click)="onCloseClick()" aria-label="Close">
        <span>×</span>
      </button>
    </div>

    <!-- Form -->
    <form [formGroup]="courseForm" (ngSubmit)="onSubmit()" class="course-form">
      
      <!-- A) Course basics -->
      <div class="form-section">
        <h2>{{ 'onb.createCourse.sections.basics.title' | translate }}</h2>
        <p class="section-description">{{ 'onb.createCourse.sections.basics.description' | translate }}</p>
        
        <div class="form-row">
          <div class="form-field full-width">
            <label for="courseName">{{ 'onb.createCourse.fields.courseName.label' | translate }}*</label>
            <input 
              id="courseName" 
              type="text" 
              formControlName="courseName"
              [placeholder]="'onb.createCourse.fields.courseName.placeholder' | translate"
              [class.invalid]="isFieldInvalid('courseName')">
            <small *ngIf="getFieldError('courseName')" class="error-message">
              {{ getFieldError('courseName') | translate }}
            </small>
            <small *ngIf="!getFieldError('courseName')" class="help-text">
              {{ 'onb.createCourse.fields.courseName.help' | translate }}
            </small>
          </div>
        </div>

        <div class="form-row">
          <div class="form-field">
            <label for="subject">{{ 'onb.createCourse.fields.subject.label' | translate }}*</label>
            <select id="subject" formControlName="subject" [class.invalid]="isFieldInvalid('subject')">
              <option value="">{{ 'onb.createCourse.fields.subject.placeholder' | translate }}</option>
              <option *ngFor="let subject of subjects" [value]="subject.value">
                {{ subject.label | translate }}
              </option>
            </select>
            <small *ngIf="getFieldError('subject')" class="error-message">
              {{ getFieldError('subject') | translate }}
            </small>
          </div>

          <div class="form-field">
            <label for="grade">{{ 'onb.createCourse.fields.grade.label' | translate }}*</label>
            <select id="grade" formControlName="grade" [class.invalid]="isFieldInvalid('grade')">
              <option value="">{{ 'onb.createCourse.fields.grade.placeholder' | translate }}</option>
              <option *ngFor="let grade of grades" [value]="grade.value">
                {{ grade.label | translate }}
              </option>
            </select>
            <small *ngIf="getFieldError('grade')" class="error-message">
              {{ getFieldError('grade') | translate }}
            </small>
          </div>
        </div>
        <div class="form-row">
          <div class="form-field full-width">
            <label>{{ 'onb.createCourse.fields.courseIcon.label' | translate }}</label>
            <div class="icon-picker">
              <button type="button" class="icon-btn" [class.selected]="selectedIcon === '📚'" (click)="selectIcon('📚')">📚</button>
              <button type="button" class="icon-btn" [class.selected]="selectedIcon === '🧮'" (click)="selectIcon('🧮')">🧮</button>
              <button type="button" class="icon-btn" [class.selected]="selectedIcon === '🔬'" (click)="selectIcon('🔬')">🔬</button>
              <button type="button" class="icon-btn" [class.selected]="selectedIcon === '🎨'" (click)="selectIcon('🎨')">🎨</button>
              <button type="button" class="icon-btn" [class.selected]="selectedIcon === '🌍'" (click)="selectIcon('🌍')">🌍</button>
              <button type="button" class="icon-btn" [class.selected]="selectedIcon === '💻'" (click)="selectIcon('💻')">💻</button>
              <button type="button" class="icon-btn" [class.selected]="selectedIcon === '⚗️'" (click)="selectIcon('⚗️')">⚗️</button>
              <button type="button" class="icon-btn" [class.selected]="selectedIcon === '📖'" (click)="selectIcon('📖')">📖</button>
              <button type="button" class="icon-btn" [class.selected]="selectedIcon === '✏️'" (click)="selectIcon('✏️')">✏️</button>
              <button type="button" class="icon-btn" [class.selected]="selectedIcon === '🏃'" (click)="selectIcon('🏃')">🏃</button>
              <button type="button" class="icon-btn" [class.selected]="selectedIcon === '🎭'" (click)="selectIcon('🎭')">🎭</button>
              <button type="button" class="icon-btn" [class.selected]="selectedIcon === '🔢'" (click)="selectIcon('🔢')">🔢</button>
              <button type="button" class="icon-btn" [class.selected]="selectedIcon === '🌱'" (click)="selectIcon('🌱')">🌱</button>
              <button type="button" class="icon-btn" [class.selected]="selectedIcon === '🚀'" (click)="selectIcon('🚀')">🚀</button>
              <button type="button" class="icon-btn" [class.selected]="selectedIcon === '🎯'" (click)="selectIcon('🎯')">🎯</button>
            </div>
          </div>
        </div>
      </div>


      <!-- C) Access & ownership -->
      <div class="form-section">
        <h2>{{ 'onb.createCourse.sections.access.title' | translate }}</h2>
        
        <div class="form-field">
          <label>{{ 'onb.createCourse.fields.visibility.label' | translate }}*</label>
          <div class="radio-group">
            <label *ngFor="let option of visibilityOptions" class="radio-option">
              <input type="radio" [value]="option.value" formControlName="visibility">
              <div class="radio-content">
                <strong>{{ option.label | translate }}</strong>
                <small>{{ option.desc | translate }}</small>
              </div>
            </label>
          </div>
        </div>

      </div>



      <!-- F) Quick section -->
      <div class="form-section">
        <h2>{{ 'onb.createCourse.sections.quickSection.title' | translate }}</h2>
        
        <div class="form-field">
          <label class="checkbox-label">
            <input type="checkbox" formControlName="createFirstSection">
            <span class="checkmark"></span>
            <div class="checkbox-content">
              <strong>{{ 'onb.createCourse.fields.createFirstSection.label' | translate }}</strong>
              <small>{{ 'onb.createCourse.fields.createFirstSection.description' | translate }}</small>
            </div>
          </label>
        </div>

        <div class="form-field" *ngIf="courseForm.get('createFirstSection')?.value">
          <label for="sectionName">{{ 'onb.createCourse.fields.sectionName.label' | translate }}</label>
          <input 
            id="sectionName" 
            type="text" 
            formControlName="sectionName"
            [placeholder]="'onb.createCourse.fields.sectionName.placeholder' | translate">
        </div>
      </div>

      <!-- Footer actions -->
      <div class="form-footer">
        <div class="footer-actions">
          <button type="button" class="btn btn-secondary" (click)="cancel()">
            {{ 'onb.createCourse.actions.cancel' | translate }}
          </button>
          <button 
            type="submit" 
            class="btn btn-primary" 
            [disabled]="courseForm.invalid || isSubmitting">
            <span *ngIf="!isSubmitting">{{ 'onb.createCourse.actions.save' | translate }}</span>
            <span *ngIf="isSubmitting">{{ 'onb.createCourse.actions.saving' | translate }}</span>
          </button>
        </div>
        <small class="footer-note">{{ 'onb.createCourse.actions.note' | translate }}</small>
      </div>
    </form>
  </div>
</div>

<!-- Unsaved Changes Warning Modal -->
<div class="warning-modal" *ngIf="showUnsavedWarning">
  <div class="warning-backdrop" (click)="hideUnsavedWarning()"></div>
  <div class="warning-content">
    <div class="warning-header">
      <h3>{{ 'onb.createCourse.warning.title' | translate }}</h3>
    </div>
    <div class="warning-body">
      <p>{{ 'onb.createCourse.warning.message' | translate }}</p>
    </div>
    <div class="warning-footer">
      <button type="button" class="btn btn-secondary" (click)="hideUnsavedWarning()">
        {{ 'onb.createCourse.warning.cancel' | translate }}
      </button>
      <button type="button" class="btn btn-danger" (click)="confirmClose()">
        {{ 'onb.createCourse.warning.discard' | translate }}
      </button>
    </div>
  </div>
</div>