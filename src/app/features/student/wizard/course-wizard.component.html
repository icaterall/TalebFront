<div class="wizard-page" [dir]="isRTL ? 'rtl' : 'ltr'">
  <!-- Hero Header with Gradient -->
  <div class="hero-header" [ngClass]="'step-' + (currentStep === 'basics' ? '2' : currentStep === 'unit' ? '3' : '4')">
    <div class="decorative-shapes">
      <div class="shape pattern-1"></div>
      <div class="shape pattern-2"></div>
    </div>
    <div class="hero-content">
      <h1>
        {{ currentStep === 'basics' ? (currentLang === 'ar' ? 'Ø£Ø³Ø§Ø³ÙŠØ§Øª Ø§Ù„Ù…Ù‚Ø±Ø±' : 'Course Basics') : 
           currentStep === 'unit' ? (currentLang === 'ar' ? 'Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰' : 'Build First Unit') :
           (currentLang === 'ar' ? 'Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆÙ†Ø´Ø±' : 'Review & Publish') }}
      </h1>
      <p>
        {{ currentStep === 'basics' ? (currentLang === 'ar' ? 'Ø§Ø³Ù… Ø§Ù„Ù…Ù‚Ø±Ø± ÙˆØ§Ù„Ù…ÙˆØ¶ÙˆØ¹ ÙˆØ§Ù„ÙˆØ­Ø¯Ø§Øª' : 'Course name, subject, and units') : 
           currentStep === 'unit' ? (currentLang === 'ar' ? 'Ø§Ù„Ø£Ù‡Ø¯Ø§Ù ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰ ÙˆØ§Ù„Ø§Ø®ØªØ¨Ø§Ø±' : 'Objectives, content, and quiz') :
           (currentLang === 'ar' ? 'ØªØ£ÙƒÙŠØ¯ ÙˆØ§Ù„Ù†Ø´Ø±' : 'Confirm and publish') }}
      </p>
    </div>
  </div>

  <!-- Wizard Card Container -->
  <div class="wizard-container">
    <!-- Wizard Steps Indicator -->
    <div class="wizard-steps">
      <div class="step" [ngClass]="getStepStatus(1).toLowerCase()">
        <span class="step-number">1</span>
        <span class="step-label">{{ currentLang === 'ar' ? 'Ø§Ù„ØªØµÙ†ÙŠÙ' : 'Category' }}</span>
        <span class="step-status">{{ getStepStatus(1) === 'Completed' ? 'âœ“' : '' }}</span>
      </div>
      <div class="step-line"></div>
      
      <div class="step" [ngClass]="getStepStatus(2).toLowerCase()">
        <span class="step-number">2</span>
        <span class="step-label">{{ currentLang === 'ar' ? 'Ø£Ø³Ø§Ø³ÙŠØ§Øª' : 'Basics' }}</span>
        <span class="step-status">{{ getStepStatus(2) === 'Completed' ? 'âœ“' : '' }}</span>
      </div>
      <div class="step-line"></div>
      
      <div class="step" [ngClass]="getStepStatus(3).toLowerCase()">
        <span class="step-number">3</span>
        <span class="step-label">{{ currentLang === 'ar' ? 'Ø§Ù„ÙˆØ­Ø¯Ø©' : 'Unit' }}</span>
        <span class="step-status">{{ getStepStatus(3) === 'Completed' ? 'âœ“' : '' }}</span>
      </div>
      <div class="step-line"></div>
      
      <div class="step" [ngClass]="getStepStatus(4).toLowerCase()">
        <span class="step-number">4</span>
        <span class="step-label">{{ currentLang === 'ar' ? 'Ù†Ø´Ø±' : 'Publish' }}</span>
        <span class="step-status">{{ getStepStatus(4) === 'Completed' ? 'âœ“' : '' }}</span>
      </div>
    </div>

    <!-- Content Area -->
    <div class="wizard-content">

      <!-- Step 2: Course Basics -->
      <div *ngIf="currentStep === 'basics'" class="step-content">
        <div class="section">
          <h2>{{ currentLang === 'ar' ? 'Ø§Ø³Ù… Ø§Ù„Ù…Ù‚Ø±Ø±' : 'Course Name' }}</h2>
          
          <!-- Suggested Titles -->
          <div class="suggested-block" *ngIf="!step2.editMode">
            <button 
              class="btn-suggest"
              (click)="suggestTitles()"
              [disabled]="step2.titleLoading">
              {{ step2.titleLoading ? '...' : (currentLang === 'ar' ? 'Ø§Ù‚ØªØ±Ø­ Ø£Ø³Ù…Ø§Ø¡' : 'Suggest Titles') }}
            </button>
            
            <div class="titles-chips" *ngIf="step2.suggestedTitles.length > 0">
              <button 
                *ngFor="let title of step2.suggestedTitles"
                class="chip"
                (click)="selectTitle(title)">
                {{ title }}
              </button>
            </div>
          </div>

          <!-- Manual Input or Selected Title -->
          <div class="input-group">
            <input 
              type="text" 
              [(ngModel)]="step2.courseTitle"
              [placeholder]="currentLang === 'ar' ? 'Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ù‚Ø±Ø± Ø£Ùˆ Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª' : 'Enter course name or select from suggestions'"
              (focus)="step2.editMode = true"
              (blur)="step2.editMode = step2.courseTitle === '' ? false : true"
              class="input">
          </div>
        </div>

        <!-- Subject Tag (Optional) -->
        <div class="section">
          <h2>{{ currentLang === 'ar' ? 'Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)' : 'Subject (Optional)' }}</h2>
          <input 
            type="text" 
            [(ngModel)]="step2.subjectTag"
            [placeholder]="currentLang === 'ar' ? 'Ù…Ø«Ø§Ù„: Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡' : 'E.g. Physics'"
            class="input">
        </div>

        <!-- Unit Map -->
        <div class="section">
          <h2>{{ currentLang === 'ar' ? 'Ø®Ø±ÙŠØ·Ø© Ø§Ù„ÙˆØ­Ø¯Ø§Øª' : 'Unit Map' }}</h2>
          
          <button 
            class="btn-suggest"
            (click)="suggestUnits()"
            [disabled]="!step2.courseTitle || step2.unitLoading">
            {{ step2.unitLoading ? '...' : (currentLang === 'ar' ? 'Ø§Ù‚ØªØ±Ø­ ÙˆØ­Ø¯Ø§Øª' : 'Suggest Units') }}
          </button>

          <div class="units-list" *ngIf="step2.units.length > 0">
            <div 
              *ngFor="let unit of step2.units; let i = index"
              class="unit-item">
              <span class="unit-number">{{ i + 1 }}</span>
              <input 
                type="text" 
                [(ngModel)]="unit.name"
                class="unit-input">
            </div>
          </div>

          <p class="hint" *ngIf="step2.units.length === 0">
            {{ currentLang === 'ar' ? 'Ø§Ø¶ØºØ· "Ø§Ù‚ØªØ±Ø­ ÙˆØ­Ø¯Ø§Øª" Ù„ØªÙˆÙ„Ø¯ ÙˆØ­Ø¯Ø§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ù…Ù‚Ø±Ø±' : 'Click "Suggest Units" to generate units based on the course name' }}
          </p>
        </div>
      </div>

      <!-- Step 3: Build First Unit -->
      <div *ngIf="currentStep === 'unit'" class="step-content">
        <div class="section">
          <h2>{{ currentLang === 'ar' ? 'Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©' : 'Learning Objectives' }}</h2>
          <div class="objectives-list">
            <div class="objective-item" *ngFor="let obj of step3.objectives; let i = index">
              <textarea 
                [(ngModel)]="step3.objectives[i]"
                [placeholder]="currentLang === 'ar' ? 'Ø§Ù„Ù‡Ø¯Ù ' + (i+1) : 'Objective ' + (i+1)"
                class="textarea"></textarea>
            </div>
          </div>
          <button 
            class="btn-add"
            (click)="step3.objectives.push('')"
            *ngIf="step3.objectives.length < 3">
            {{ currentLang === 'ar' ? 'Ø¥Ø¶Ø§ÙØ© Ù‡Ø¯Ù' : 'Add Objective' }}
          </button>
        </div>

        <div class="section">
          <h2>{{ currentLang === 'ar' ? 'Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙˆØ­Ø¯Ø©' : 'Unit Content' }}</h2>
          <p class="hint">
            {{ currentLang === 'ar' ? 'Ø£Ø¶Ù Ù…Ø­ØªÙˆÙ‰ Ø¨Ø³ÙŠØ· (Ù†ØµÙˆØµ ÙˆØ£Ù…Ø«Ù„Ø©)' : 'Add simple content (text and examples)' }}
          </p>
        </div>

        <div class="section">
          <h2>{{ currentLang === 'ar' ? 'Ø§Ø®ØªØ¨Ø§Ø± Ø³Ø±ÙŠØ¹' : 'Quick Quiz' }}</h2>
          <p class="hint">
            {{ currentLang === 'ar' ? '3 Ø£Ø³Ø¦Ù„Ø© Ù…ØªØ¹Ø¯Ø¯Ø© Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª (Ø³Ù‡Ù„ØŒ Ù…ØªÙˆØ³Ø·ØŒ ØµØ¹Ø¨)' : '3 multiple-choice questions (easy, medium, hard)' }}
          </p>
        </div>
      </div>

      <!-- Step 4: Review & Publish -->
      <div *ngIf="currentStep === 'review'" class="step-content">
        <div class="review-section">
          <h2>{{ currentLang === 'ar' ? 'Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ù‚Ø±Ø±' : 'Course Summary' }}</h2>
          
          <div class="review-item">
            <span class="label">{{ currentLang === 'ar' ? 'Ø§Ø³Ù… Ø§Ù„Ù…Ù‚Ø±Ø±:' : 'Course Name:' }}</span>
            <span class="value">{{ step2.courseTitle }}</span>
          </div>
          
          <div class="review-item">
            <span class="label">{{ currentLang === 'ar' ? 'Ø§Ù„ØªØµÙ†ÙŠÙ:' : 'Category:' }}</span>
            <span class="value">{{ draft?.category_name }}</span>
          </div>

          <div class="review-item">
            <span class="label">{{ currentLang === 'ar' ? 'Ø§Ù„ÙˆØ­Ø¯Ø§Øª:' : 'Units:' }}</span>
            <div class="units-summary">
              <div *ngFor="let unit of step2.units" class="unit-summary-item">
                â€¢ {{ unit.name }}
              </div>
            </div>
          </div>
        </div>

        <div class="review-section">
          <h2>{{ currentLang === 'ar' ? 'Ø§Ù„Ø±Ø¤ÙŠØ© ÙˆØ§Ù„ØªÙˆØ§ÙÙ‚' : 'Visibility & Availability' }}</h2>
          
          <div class="form-group">
            <label>{{ currentLang === 'ar' ? 'Ù…Ù† ÙŠÙ…ÙƒÙ†Ù‡ Ø±Ø¤ÙŠØ© Ù‡Ø°Ø§ Ø§Ù„Ù…Ù‚Ø±Ø±ØŸ' : 'Who can see this course?' }}</label>
            <select [(ngModel)]="step4.visibility" class="select">
              <option value="public">{{ currentLang === 'ar' ? 'Ø¹Ø§Ù… (Ù„Ù„Ø¬Ù…ÙŠØ¹)' : 'Public (Everyone)' }}</option>
              <option value="restricted">{{ currentLang === 'ar' ? 'Ù…Ù‚ÙŠØ¯ (Ø¨Ù†ÙØ³ Ø§Ù„Ù…Ø±Ø­Ù„Ø© ÙˆØ§Ù„Ø¯ÙˆÙ„Ø©)' : 'Restricted (Same stage & country)' }}</option>
              <option value="private">{{ currentLang === 'ar' ? 'Ø®Ø§Øµ (Ø£Ù†Øª ÙÙ‚Ø·)' : 'Private (You only)' }}</option>
            </select>
          </div>

          <div class="form-group">
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="step4.createSection">
              {{ currentLang === 'ar' ? 'Ø¥Ù†Ø´Ø§Ø¡ Ù‚Ø³Ù… Ù„ÙŠØ¨Ø¯Ø£ Ø§Ù„Ø·Ù„Ø§Ø¨ ÙÙˆØ±Ø§Ù‹' : 'Create a section so students can start immediately' }}
            </label>
          </div>
        </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="wizard-actions">
      <button 
        class="btn-back"
        (click)="goBack()">
        {{ currentLang === 'ar' ? 'Ø±Ø¬ÙˆØ¹' : 'Back' }}
      </button>

      <button 
        class="btn-continue"
        *ngIf="currentStep !== 'review'"
        [disabled]="(currentStep === 'basics' && (!step2.courseTitle || step2.units.length === 0)) || (currentStep === 'unit' && step3.objectives.length === 0)"
        (click)="currentStep === 'basics' ? continueToStep3() : continueToStep4()">
        <span class="btn-icon">ğŸ¤–</span>
        <span>{{ currentLang === 'ar' ? 'Ù…ØªØ§Ø¨Ø¹Ø©' : 'Continue' }}</span>
      </button>

      <button 
        class="btn-publish"
        *ngIf="currentStep === 'review'"
        [disabled]="step4.publishing"
        (click)="publishCourse()">
        <span class="btn-icon">ğŸš€</span>
        <span>{{ step4.publishing ? (currentLang === 'ar' ? 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù†Ø´Ø±...' : 'Publishing...') : (currentLang === 'ar' ? 'Ù†Ø´Ø± Ø§Ù„Ù…Ù‚Ø±Ø±' : 'Publish Course') }}</span>
      </button>
    </div>
  </div>
</div>
