<div class="course-preview-ar" [class.rtl]="currentLang === 'ar'">
  <div class="loading-container" *ngIf="loading">
    <div class="spinner-large"></div>
    <p>{{ currentLang === 'ar' ? 'Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¯ÙˆØ±Ø©...' : 'Loading course preview...' }}</p>
  </div>

  <ng-container *ngIf="!loading && course as c">
    <div class="course-preview-layout" [class.rtl]="currentLang === 'ar'">
      <!-- Main Content: Hero + Learning -->
      <div class="main-content-area">
        <!-- Hero Card -->
        <div class="hero-card">
          <div class="hero-header">
            <div class="hero-badge">{{ currentLang === 'ar' ? 'Ù…Ø³ÙˆØ¯Ø©' : 'Draft' }}</div>
            <h1 class="hero-title">{{ c.name }}</h1>
            <p class="hero-description" *ngIf="c.description">{{ c.description }}</p>
          </div>

          <div class="hero-stats">
            <div class="stat-card">
              <div class="stat-icon">ğŸ“š</div>
              <div class="stat-info">
                <div class="stat-value">{{ c.sections?.length || 0 }}</div>
                <div class="stat-label">{{ currentLang === 'ar' ? 'Ø£Ù‚Ø³Ø§Ù…' : 'Sections' }}</div>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">ğŸ“</div>
              <div class="stat-info">
                <div class="stat-value">{{ c.total_lessons || 0 }}</div>
                <div class="stat-label">{{ currentLang === 'ar' ? 'Ø¯Ø±ÙˆØ³' : 'Lessons' }}</div>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">ğŸ‘¥</div>
              <div class="stat-info">
                <div class="stat-value">{{ formatStudentCount(c.student_count) }}</div>
                <div class="stat-label"></div>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">â­</div>
              <div class="stat-info">
                <div class="stat-value">{{ formatRating(c.rating) }}</div>
                <div class="stat-label">{{ currentLang === 'ar' ? 'Ø§Ù„ØªÙ‚ÙŠÙŠÙ…' : 'Rating' }}</div>
              </div>
            </div>
          </div>

          <div class="hero-footer">
            <div class="teacher-info">
              <img [src]="c.teacher?.avatar_url || 'assets/images/default-avatar.png'" 
                   [alt]="c.teacher?.name || 'Instructor'"
                   class="teacher-avatar">
              <div class="teacher-details">
                <span class="teacher-label">{{ currentLang === 'ar' ? 'Ø§Ù„Ù…ÙÙ‚Ø¯Ù‘ÙÙ…' : 'Instructor' }}</span>
                <span class="teacher-name">{{ c.teacher?.name }}</span>
              </div>
            </div>
            <div class="hero-buttons">
              <button class="btn-publish" (click)="publishCourse()" [disabled]="publishing">
                <span *ngIf="!publishing">{{ currentLang === 'ar' ? 'Ù†Ø´Ø± Ø§Ù„Ø¯ÙˆØ±Ø©' : 'Publish course' }}</span>
                <span *ngIf="publishing">{{ currentLang === 'ar' ? 'Ø¬Ø§Ø±Ù Ø§Ù„Ù†Ø´Ø±...' : 'Publishing...' }}</span>
              </button>
              <button class="btn-back" (click)="backToBuilder()">
                {{ currentLang === 'ar' ? 'Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„' : 'Back to edit' }}
              </button>
            </div>
          </div>
        </div>

        <!-- What You'll Learn Card -->
        <div class="learning-card" *ngIf="learningHighlights.length">
          <h2 class="card-title">
            <span class="title-icon">ğŸ¯</span>
            {{ currentLang === 'ar' ? 'Ù…Ø§ Ø§Ù„Ø°ÙŠ Ø³ØªØªØ¹Ù„Ù…Ù‡' : "What you'll learn" }}
          </h2>
          <div class="learning-list">
            <div class="learning-item" *ngFor="let highlight of learningHighlights">
              <div class="check-mark">âœ“</div>
              <p>{{ highlight }}</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Sidebar: Course Sections -->
      <aside class="sections-sidebar">
        <div class="sidebar-header">
          <h3>{{ currentLang === 'ar' ? 'Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¯ÙˆØ±Ø©' : 'Course Content' }}</h3>
          <p class="sidebar-subtitle">
            {{ c.sections?.length || 0 }} {{ currentLang === 'ar' ? 'Ù‚Ø³Ù…' : 'sections' }} â€¢ 
            {{ c.total_lessons }} {{ currentLang === 'ar' ? 'Ø¯Ø±Ø³' : 'lessons' }}
          </p>
        </div>
        <div class="sections-list">
          <div class="section-card" *ngFor="let section of c.sections">
            <button class="section-header" (click)="toggleSection(section)">
              <div class="section-info">
                <div class="section-icon">{{ section.icon || 'ğŸ“–' }}</div>
                <div>
                  <h4 class="section-title">{{ section.name }}</h4>
                  <p class="section-meta">
                    {{ section.content_items.length }} {{ currentLang === 'ar' ? 'Ø¯Ø±Ø³' : 'lessons' }}
                    <span *ngIf="section.total_duration"> â€¢ {{ formatDuration(section.total_duration) }}</span>
                  </p>
                </div>
              </div>
              <span class="expand-arrow" [class.expanded]="section.isExpanded">â–¼</span>
            </button>
            <div class="section-content" *ngIf="section.isExpanded" [@expandCollapse]="section.isExpanded ? 'expanded' : 'collapsed'">
              <div class="lesson-item" *ngFor="let item of section.content_items" (click)="onContentClick({sectionId: section.id, contentId: item.id})">
                <div class="lesson-icon">{{ getContentIcon(item.type) }}</div>
                <div class="lesson-details">
                  <p class="lesson-title">{{ item.title }}</p>
                  <span class="lesson-meta">
                    {{ getContentTypeLabel(item.type) }}
                    <span *ngIf="item.duration"> â€¢ {{ formatDuration(item.duration) }}</span>
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </aside>
    </div>
  </ng-container>
</div>
