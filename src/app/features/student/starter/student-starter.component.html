<div class="starter-page" [dir]="isRTL ? 'rtl' : 'ltr'">
  
  <!-- Vibrant Hero Header with Gradient -->
  <div class="hero-header">
    <div class="decorative-shapes">
      <div class="shape-pattern"></div>
      <div class="shape-circle-1"></div>
      <div class="shape-circle-2"></div>
    </div>
    
    <div class="hero-content">
      <div class="badge-group">
        <span class="badge">ğŸ“ {{ stageName }}</span>
        <span class="badge">ğŸŒ {{ countryName }}</span>
      </div>
      <h1>{{ currentLang === 'ar' ? 'âœ¨ Ø£Ù†Ø´Ø¦ Ø¯Ø±Ø³Ùƒ Ù…Ø¹ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ' : 'âœ¨ Create Your Course with AI' }}</h1>
      <p class="hero-subtitle">
        {{ currentLang === 'ar' 
          ? 'Ø§Ø®ØªØ± Ù…ÙˆØ¶ÙˆØ¹Ù‹Ø§ ÙˆØ§Ø­Ø¯Ù‹Ø§ ÙˆØ³ÙŠØ³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙÙŠ Ø¨Ù†Ø§Ø¡ Ø¯Ø±Ø³ Ø§Ø­ØªØ±Ø§ÙÙŠ Ø®Ø·ÙˆØ© Ø¨Ø®Ø·ÙˆØ©.'
          : 'Pick one topic and AI will help you build a professional course step by step.' }}
      </p>
    </div>
  </div>

  <!-- Wizard Card Overlapping Hero -->
  <div class="wizard-card">
    <div class="wizard-card-inner">
    <!-- Wizard Progress -->
    <div class="wizard-progress">
      <div class="progress-step" [ngClass]="{'completed': step2Locked || currentStep > 1, 'current': currentStep === 1 && !step2Locked}">
        <div class="step-circle">
          <ng-container *ngIf="step2Locked || currentStep > 1; else stepOne">
            <span class="check-icon">âœ”</span>
          </ng-container>
          <ng-template #stepOne>1</ng-template>
        </div>
        <div class="step-labels">
          <span class="step-name">{{ currentLang === 'ar' ? 'Ø£Ø³Ø§Ø³ÙŠØ§Øª Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©' : 'Course Basics' }}</span>
        </div>
      </div>
      <div class="progress-step" [ngClass]="{'completed': currentStep > 2, 'current': currentStep === 2, 'pending': currentStep < 2}">
        <div class="step-circle">
          <ng-container *ngIf="currentStep > 2; else stepTwo">
            <span class="check-icon">âœ”</span>
          </ng-container>
          <ng-template #stepTwo>2</ng-template>
        </div>
        <div class="step-labels">
          <span class="step-name">{{ currentLang === 'ar' ? 'Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø§Ù‚Ø³Ø§Ù…' : 'Building Sections' }}</span>
        </div>
      </div>
      <div class="progress-step pending">
        <div class="step-circle">3</div>
        <div class="step-labels">
          <span class="step-name">{{ currentLang === 'ar' ? 'Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆÙ†Ø´Ø±' : 'Review & Publish' }}</span>
        </div>
      </div>
    </div>

    <!-- Wizard Body -->
    <div class="wizard-body">
      <!-- Step 1: Category Selection -->
      <div *ngIf="showStep1" class="step-content step1-content">
        <!-- Read-only Summary (shown when step2Locked is true) -->
        <div class="read-only-summary" *ngIf="step2Locked && selectedCategory" [dir]="isRTL ? 'rtl' : 'ltr'">
          <div class="summary-main">
            <div class="summary-item summary-item-with-action">
              <div class="summary-content">
                <span class="summary-label">{{ currentLang === 'ar' ? 'Ø§Ù„ØªØµÙ†ÙŠÙ:' : 'Category:' }}</span>
                <span class="summary-icon">{{ selectedCategory.icon }}</span>
                <span class="summary-value">{{ getCategoryName(selectedCategory) }}</span>
              </div>
              <button 
                type="button" 
                class="btn-start-from-scratch"
                (click)="showStartFromScratchModal = true"
                [attr.aria-label]="currentLang === 'ar' ? 'Ø¨Ø¯Ø¡ Ù…Ù† Ø¬Ø¯ÙŠØ¯' : 'Start from Scratch'">
                <span class="btn-icon">ğŸ”„</span>
                <span class="btn-text">{{ currentLang === 'ar' ? 'Ø¨Ø¯Ø¡ Ù…Ù† Ø¬Ø¯ÙŠØ¯' : 'Start from Scratch' }}</span>
              </button>
            </div>
            <div class="summary-item">
              <span class="summary-label">{{ currentLang === 'ar' ? 'Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©:' : 'Course Name:' }}</span>
              <span class="summary-value">
                <span *ngIf="!editingCourseName && !savingCourseName">{{ courseName }}</span>
                <span *ngIf="savingCourseName" class="saving-indicator">
                  <span class="saving-spinner"></span>
                  <span class="saving-text">{{ currentLang === 'ar' ? 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...' : 'Saving...' }}</span>
                </span>
                <input 
                  *ngIf="editingCourseName && !savingCourseName"
                  type="text"
                  class="inline-edit-input"
                  [(ngModel)]="editingCourseNameValue"
                  (keyup.enter)="saveCourseNameEdit()"
                  (keyup.escape)="cancelCourseNameEdit()"
                  [placeholder]="currentLang === 'ar' ? 'Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©' : 'Course Name'"
                  [dir]="isRTL ? 'rtl' : 'ltr'"
                  maxlength="200">
                <div class="summary-action-buttons">
                  <button *ngIf="!editingCourseName && !savingCourseName" type="button" class="summary-edit-btn" (click)="startEditingCourseName()" [attr.aria-label]="currentLang === 'ar' ? 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©' : 'Edit Course Name'">âœï¸</button>
                  <div *ngIf="editingCourseName && !savingCourseName" class="inline-edit-actions">
                    <button type="button" class="inline-edit-btn inline-edit-cancel" (click)="cancelCourseNameEdit()" [attr.aria-label]="currentLang === 'ar' ? 'Ø¥Ù„ØºØ§Ø¡' : 'Cancel'">âœ•</button>
                    <button type="button" class="inline-edit-btn inline-edit-save" (click)="saveCourseNameEdit()" [attr.aria-label]="currentLang === 'ar' ? 'Ø­ÙØ¸' : 'Save'">âœ“</button>
                  </div>
                </div>
              </span>
            </div>
          </div>
          <app-cover-image
            [courseCoverPreview]="courseCoverPreview"
            [defaultCourseCover]="defaultCourseCover"
            [courseCoverUploading]="courseCoverUploading"
            [courseCoverDeleting]="courseCoverDeleting"
            [courseCoverUploadProgress]="courseCoverUploadProgress"
            [courseCoverUploadError]="courseCoverUploadError"
            [hasCustomCourseCover]="hasCustomCourseCover"
            [coverImageLoaded]="coverImageLoaded"
            [currentLang]="currentLang"
            (select)="onCourseCoverSelected($event)"
            (openDelete)="showDeleteCoverModal = true"
            (confirmDelete)="confirmDeleteCover()"
            (imageLoad)="onCoverImageLoad()"
            (imageError)="onCoverImageError()">
          </app-cover-image>
        </div>

        <!-- Sections List (Multiple Sections Support) -->
        <div class="sections-list" *ngIf="step2Locked && selectedCategory && (selectedTopic || subjectSlug || sections.length > 0)" [dir]="isRTL ? 'rtl' : 'ltr'">
          <!-- Loop through sections -->
          <div 
            *ngFor="let section of sections; let i = index; trackBy: trackBySectionId"
            class="section-wrapper"
            [class.collapsed]="section.isCollapsed"
            [attr.data-section-id]="section.id">
            
            <!-- Section Header -->
            <div 
              class="section-content-header"
              [attr.data-section-id]="section.id"
              tabindex="0"
              (click)="toggleSectionFold(section.id)"
              (keydown.enter)="toggleSectionFold(section.id)">
              
              <div class="section-header-main">
                <button 
                  type="button"
                  class="section-fold-btn"
                  [class.collapsed]="section.isCollapsed"
                  [attr.aria-label]="section.isCollapsed ? (currentLang === 'ar' ? 'ØªÙˆØ³ÙŠØ¹ Ø§Ù„Ù‚Ø³Ù…' : 'Expand section') : (currentLang === 'ar' ? 'Ø·ÙŠ Ø§Ù„Ù‚Ø³Ù…' : 'Collapse section')">
                  <span class="fold-icon">{{ section.isCollapsed ? 'â–¶' : 'â–¼' }}</span>
                </button>

                <div class="section-order-controls">
                  <button
                    type="button"
                    class="section-order-btn"
                    (click)="$event.stopPropagation(); moveSectionUp(section.id)"
                    [disabled]="i === 0"
                    [attr.aria-label]="currentLang === 'ar' ? 'ØªØ­Ø±ÙŠÙƒ Ù„Ù„Ø£Ø¹Ù„Ù‰' : 'Move up'">
                    <span class="order-icon">â¬†ï¸</span>
                  </button>
                  <button
                    type="button"
                    class="section-order-btn"
                    (click)="$event.stopPropagation(); moveSectionDown(section.id)"
                    [disabled]="i === sections.length - 1"
                    [attr.aria-label]="currentLang === 'ar' ? 'ØªØ­Ø±ÙŠÙƒ Ù„Ù„Ø£Ø³ÙÙ„' : 'Move down'">
                    <span class="order-icon">â¬‡ï¸</span>
                  </button>
                </div>

                <div class="section-header-info">
                  <div class="section-title-row">
                    <ng-container *ngIf="editingSection && editingSectionId === section.id; else sectionTitleDisplay">
                      <input
                        type="text"
                        class="section-name-edit-input"
                        [(ngModel)]="editingSectionValue"
                        (click)="$event.stopPropagation()"
                        (keyup.enter)="saveSectionEdit()"
                        (keyup.escape)="cancelSectionEdit()"
                        [placeholder]="currentLang === 'ar' ? 'Ø§Ø³Ù… Ø§Ù„Ù‚Ø³Ù…' : 'Section name'"
                        [dir]="isRTL ? 'rtl' : 'ltr'"
                        maxlength="200"
                        autofocus>
                    </ng-container>
                    <ng-template #sectionTitleDisplay>
                      <h3 class="section-name"
                          (click)="$event.stopPropagation(); renameSection(section.id)">
                        <span class="section-number">{{ currentLang === 'ar' ? 'Ø§Ù„Ù‚Ø³Ù…' : 'Section' }} {{ section.number }}</span>
                        <span class="section-title">{{ section.name }}</span>
                      </h3>
                    </ng-template>

                    <div class="section-title-actions">
                      <button
                        type="button"
                        class="section-icon-btn"
                        (click)="$event.stopPropagation(); renameSection(section.id)"
                        [attr.aria-label]="currentLang === 'ar' ? 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‚Ø³Ù…' : 'Edit section'">
                        âœï¸
                      </button>
                      <button
                        type="button"
                        class="section-icon-btn section-delete-btn"
                        (click)="$event.stopPropagation(); deleteSection(section.id)"
                        [attr.aria-label]="currentLang === 'ar' ? 'Ø­Ø°Ù Ø§Ù„Ù‚Ø³Ù…' : 'Delete section'">
                        ğŸ—‘ï¸
                      </button>
                      <button
                        type="button"
                        class="section-toggle-switch"
                        (click)="toggleSectionAvailability(section.id, $event)"
                        role="switch"
                        [attr.aria-checked]="section.available !== false"
                        [attr.aria-label]="section.available !== false ? (currentLang === 'ar' ? 'Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù‚Ø³Ù…' : 'Hide section') : (currentLang === 'ar' ? 'Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø³Ù…' : 'Show section')"
                        [class.active]="section.available !== false">
                        <span class="switch-track">
                          <span class="switch-handle"></span>
                        </span>
                      
                      </button>
                    </div>
                  </div>

                  <div class="section-meta">
                    <span class="section-item-count">
                      {{ getItemCountDisplay(section.content_items?.length || 0) }}
                    </span>
                    <span class="section-visibility" [class.hidden]="section.available === false">
                      {{ section.available !== false ? (currentLang === 'ar' ? 'Ù…ØªØ§Ø­' : 'Visible') : (currentLang === 'ar' ? 'Ù…Ø®ÙÙŠ' : 'Hidden') }}
                    </span>
                    <span class="section-created-at" *ngIf="section.createdAt">
                      {{ formatContentDate(section.createdAt) }}
                    </span>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Section Content (collapsible) -->
            <div class="section-content-body" *ngIf="!section.isCollapsed">
              <!-- Content Items List -->
              <div class="content-items-list" *ngIf="section.content_items && section.content_items.length > 0">
                <div 
                  *ngFor="let item of section.content_items; let j = index; trackBy: trackByContentId"
                  class="content-item-card"
                  [class.content-type-text]="item.type === 'text'"
                  [class.content-type-resources]="item.type === 'resources'"
                  [class.content-type-video]="item.type === 'video'"
                  [class.content-type-audio]="item.type === 'audio'"
                  [class.content-type-quiz]="item.type === 'quiz'"
                  (click)="openContentItem(item)"
                  [style.cursor]="(item.type === 'video' || item.type === 'audio' || item.type === 'resources') ? 'pointer' : 'default'">
                  
                  <div class="content-item-header">
                    <div class="content-item-main">
                      <div class="content-order-inline">
                        <button 
                          type="button" 
                          class="order-btn" 
                          (click)="moveContentItemUp(j, section.id)"
                          [disabled]="isReordering(item.id) || j === 0"
                          [attr.aria-busy]="isReordering(item.id) ? 'true' : null"
                          [attr.aria-label]="currentLang === 'ar' ? 'ØªØ­Ø±ÙŠÙƒ Ù„Ù„Ø£Ø¹Ù„Ù‰' : 'Move up'">
                          â¬†ï¸
                        </button>
                        <button 
                          type="button" 
                          class="order-btn" 
                          (click)="moveContentItemDown(j, section.id)"
                          [disabled]="isReordering(item.id) || j === section.content_items.length - 1"
                          [attr.aria-busy]="isReordering(item.id) ? 'true' : null"
                          [attr.aria-label]="currentLang === 'ar' ? 'ØªØ­Ø±ÙŠÙƒ Ù„Ù„Ø£Ø³ÙÙ„' : 'Move down'">
                          â¬‡ï¸
                        </button>
                        <span class="order-loading" *ngIf="isReordering(item.id)">â³</span>
                      </div>
                      <div class="content-item-type-icon">
                        <span *ngIf="item.type === 'text'">ğŸ“</span>
                        <span *ngIf="item.type === 'resources'">ğŸ“„</span>
                        <span *ngIf="item.type === 'video'">ğŸ¥</span>
                        <span *ngIf="item.type === 'audio'">ğŸ§</span>
                        <span *ngIf="item.type === 'quiz'">ğŸ“‹</span>
                      </div>
                      <div class="content-item-text" (click)="viewContentItem(item)">
                        <h4 class="content-item-title">{{ item.title }}</h4>
                        <div class="content-item-preview" *ngIf="item.type === 'text' && item.content">
                          <p class="content-text-preview">
                            {{ getTextPreview(item.content) }}
                          </p>
                        </div>
                        <div class="content-item-preview" *ngIf="item.type === 'resources' && item.resourceDetails">
                          <ng-container *ngFor="let entry of getResourceDetailEntries(item.resourceDetails); let last = last">
                            <span class="content-detail"><strong>{{ entry.label }}:</strong> {{ entry.value }}</span><span *ngIf="!last">{{ getResourceDetailSeparator() }}</span>
                          </ng-container>
                        </div>
                        <div class="content-item-preview" *ngIf="item.type === 'video' && item.meta">
                          <ng-container *ngFor="let entry of getVideoDetailEntries(item); let last = last">
                            <span class="content-detail"><strong>{{ entry.label }}:</strong> {{ entry.value }}</span><span *ngIf="!last">{{ getResourceDetailSeparator() }}</span>
                          </ng-container>
                        </div>
                        <div class="content-item-preview" *ngIf="item.type === 'audio' && item.meta">
                          <!-- Audio Player -->
                          <div class="content-audio-player" *ngIf="item.meta['dataUrl']">
                            <audio 
                              [src]="item.meta['dataUrl']"
                              controls
                              preload="metadata"
                              class="mini-audio-player"
                              (click)="$event.stopPropagation()">
                            </audio>
                          </div>
                          <!-- Audio Details -->
                          <div class="content-audio-details">
                            <ng-container *ngFor="let entry of getAudioDetailEntries(item); let last = last">
                              <span class="content-detail"><strong>{{ entry.label }}:</strong> {{ entry.value }}</span><span *ngIf="!last">{{ getResourceDetailSeparator() }}</span>
                            </ng-container>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="content-item-header-actions">
                      <div class="content-action-icons">
                        <button
                          type="button"
                          class="content-toggle-switch"
                          (click)="$event.stopPropagation(); toggleContentStatus(section.id, item.id, $event)"
                          role="switch"
                          [attr.aria-checked]="isContentStatusActive(item)"
                          [attr.aria-label]="isContentStatusActive(item) ? (currentLang === 'ar' ? 'Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø­ØªÙˆÙ‰' : 'Deactivate content') : (currentLang === 'ar' ? 'ØªÙ†Ø´ÙŠØ· Ø§Ù„Ù…Ø­ØªÙˆÙ‰' : 'Activate content')"
                          [class.active]="isContentStatusActive(item)"
                          [disabled]="isContentStatusWaiting(item)">
                          <span class="switch-track">
                            <span class="switch-handle"></span>
                          </span>
                        </button>
 
                         <span class="status-inline" *ngIf="isContentStatusWaiting(item)">
                           â³
                         </span>

                        <button
                          type="button"
                          class="content-icon-btn delete"
                          (click)="$event.stopPropagation(); deleteContentItem(item.id)"
                          [attr.aria-label]="currentLang === 'ar' ? 'Ø­Ø°Ù Ø§Ù„Ù…Ø­ØªÙˆÙ‰' : 'Delete content'">
                          ğŸ—‘ï¸
                        </button>
                      </div>
                      <div class="content-item-meta" *ngIf="item.createdAt || item.status !== undefined && item.status !== null">
                        <span class="content-item-date" *ngIf="item.createdAt">
                          {{ formatContentDate(item.createdAt) }}
                        </span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Add Content Buttons -->
              <div class="add-content-actions">
                <button type="button" class="add-content-btn" (click)="setActiveSection(section.id); openContentTypeModal('text')">
                  <span class="btn-icon">ğŸ“</span>
                  <span class="btn-text">{{ currentLang === 'ar' ? 'Ø¥Ø¶Ø§ÙØ© Ø¯Ø±Ø³ Ù†ØµÙŠ' : 'Add Text Lesson' }}</span>
                </button>
                <button type="button" class="add-content-btn" (click)="setActiveSection(section.id); openContentTypeModal('resources')">
                  <span class="btn-icon">ğŸ“„</span>
                  <span class="btn-text">{{ currentLang === 'ar' ? 'Ø¥Ø¶Ø§ÙØ© Ù…Ù„ÙØ§Øª' : 'Add Resources' }}</span>
                </button>
                <button type="button" class="add-content-btn" (click)="setActiveSection(section.id); openContentTypeModal('video')">
                  <span class="btn-icon">ğŸ¥</span>
                  <span class="btn-text">{{ currentLang === 'ar' ? 'Ø¥Ø¶Ø§ÙØ© ÙÙŠØ¯ÙŠÙˆ' : 'Add Video' }}</span>
                </button>
                <button type="button" class="add-content-btn" (click)="setActiveSection(section.id); openContentTypeModal('audio')">
                  <span class="btn-icon">ğŸ§</span>
                  <span class="btn-text">{{ currentLang === 'ar' ? 'Ø¥Ø¶Ø§ÙØ© ØµÙˆØª' : 'Add Audio' }}</span>
                </button>
                <button type="button" class="add-content-btn" (click)="setActiveSection(section.id); openContentTypeModal('quiz')">
                  <span class="btn-icon">ğŸ“‹</span>
                  <span class="btn-text">{{ currentLang === 'ar' ? 'Ø¥Ø¶Ø§ÙØ© Ø§Ø®ØªØ¨Ø§Ø±' : 'Add Quiz' }}</span>
                </button>
              </div>
            </div>
          </div>

          <!-- Add New Section Button (Full-width ghost button under last section) -->
          <button
            type="button"
            class="btn-add-section"
            (click)="addNewSection()"
            [attr.aria-label]="currentLang === 'ar' ? 'Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ù… Ø¬Ø¯ÙŠØ¯' : 'Add new section'">
            <span class="btn-icon">â•</span>
            <span class="btn-text">{{ currentLang === 'ar' ? 'Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ù… Ø¬Ø¯ÙŠØ¯' : 'Add New Section' }}</span>
          </button>
        </div>

        <!-- Skeleton Loader for Read-only Summary (shown when loading or data is being fetched) -->
        <div class="read-only-summary read-only-summary-skeleton" *ngIf="showSummarySkeleton" [dir]="isRTL ? 'rtl' : 'ltr'">
          <div class="summary-item summary-item-with-action">
            <div class="summary-content">
              <span class="summary-label skeleton-text"></span>
              <span class="summary-icon skeleton-icon"></span>
              <span class="summary-value skeleton-text"></span>
            </div>
            <div class="btn-start-from-scratch skeleton-button"></div>
          </div>
          <div class="summary-item">
            <span class="summary-label skeleton-text"></span>
            <span class="summary-value skeleton-text"></span>
          </div>
        </div>

        <!-- Selected Category Display (Box style with Change button - shown in Step 1) -->
        <div class="selected-display" *ngIf="selectedCategory && !step2Locked">
          <div class="selected-badge">
            <span class="selected-icon">{{ selectedCategory.icon }}</span>
            <div class="selected-info">
              <span class="selected-label">{{ currentLang === 'ar' ? 'Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹ Ø§Ù„Ù…Ø®ØªØ§Ø±' : 'Selected Category' }}</span>
              <span class="selected-name">{{ getCategoryName(selectedCategory) }}</span>
            </div>
            <button class="change-btn" (click)="clearCategorySelection()">
              {{ currentLang === 'ar' ? 'ØªØºÙŠÙŠØ±' : 'Change' }}
            </button>
          </div>
        </div>

        <!-- Course Title Section (Shows after category selection) -->
        <div class="course-title-section" *ngIf="selectedCategory && !step2Locked">
          <!-- Loading Spinner - hidden when locked -->
          <div class="loading-container" *ngIf="!step2Locked && loadingTitles">
            <div class="spinner"></div>
            <p class="loading-text">{{ currentLang === 'ar' ? 'Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø§Ù„Ø£Ø³Ù…Ø§Ø¡...' : 'Loading course name suggestions...' }}</p>
          </div>

          <!-- AI Title Suggestions (Cards) - hidden when locked - shown at top -->
          <div class="title-cards-container" *ngIf="!step2Locked && !loadingTitles && courseTitleSuggestions.length > 0">
            <div class="title-cards-grid">
              <div
                *ngFor="let titleCard of courseTitleSuggestions"
                class="title-card"
                [class.selected]="courseName === titleCard.title"
                (click)="selectTitleSuggestion(titleCard)">
                <div class="title-card-header">
                  <h3 class="title-card-title">{{ titleCard.title }}</h3>
                  <div class="title-card-info" *ngIf="titleCard.rationale" [title]="titleCard.rationale">
                    <span class="info-icon">â„¹ï¸</span>
                  </div>
                </div>
                <p class="title-card-rationale" *ngIf="titleCard.rationale">{{ titleCard.rationale }}</p>
              </div>
            </div>
          </div>

          <!-- Course Name Input with AI Generate Button -->
          <div class="field-group course-name-input-group" *ngIf="!step2Locked">
            <label class="field-label">
              {{ currentLang === 'ar' ? 'Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©' : 'Course Name' }}
              <span class="required">*</span>
            </label>
            <div class="course-name-input-row">
              <input
                type="text"
                class="course-name-input"
                [(ngModel)]="courseName"
                (input)="onCourseNameChange()"
                [placeholder]="currentLang === 'ar' ? 'Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©...' : 'Enter course name...'"
                maxlength="80" />
              <button
                type="button"
                class="btn-generate-ai"
                *ngIf="!loadingTitles && courseTitleSuggestions.length === 0"
                (click)="loadTitleSuggestions()"
                [disabled]="loadingTitles">
                <span class="ai-icon">ğŸ¤–</span>
                <span class="btn-text">{{ currentLang === 'ar' ? 'Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ' : 'Generate with AI' }}</span>
              </button>
            </div>
            <div class="field-help">
              <span *ngIf="courseTitleSuggestions.length === 0">
                {{ currentLang === 'ar' ? 'Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© ÙŠØ¯ÙˆÙŠØ§Ù‹ Ø£Ùˆ Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ' : 'Type the course name manually or click the button to generate suggestions with AI' }}
              </span>
              <span *ngIf="courseTitleSuggestions.length > 0">
                {{ currentLang === 'ar' ? 'Ø§Ø®ØªØ± Ø¹Ù†ÙˆØ§Ù†Ø§Ù‹ Ù…Ù† Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø£Ø¹Ù„Ø§Ù‡ Ø£Ùˆ Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© ÙŠØ¯ÙˆÙŠØ§Ù‹' : 'Select a title from suggestions above or type the course name manually' }}
              </span>
            </div>
          </div>

          <!-- Topic Selection (shown when title card is selected in Step 1) -->
          <!-- Show topic field only if AI was not used (manual course name entry) -->
          <div class="field-group" *ngIf="courseName && !step2Locked && courseTitleSuggestions.length === 0">
            <label class="field-label" *ngIf="!selectedTopic">
              {{ currentLang === 'ar' ? 'Ø§Ù„Ù‚Ø³Ù…' : 'Section' }}
              <span class="required">*</span>
            </label>

            <!-- Stored Topic (one line with underline) - only show when locked (after Continue) -->
            <div class="inline-field-display" *ngIf="selectedTopic && step2Locked" [dir]="isRTL ? 'rtl' : 'ltr'">
              <span class="inline-label">{{ currentLang === 'ar' ? 'Ø§Ù„Ù‚Ø³Ù…:' : 'Section:' }}</span>
              <span class="inline-value underlined">{{ selectedTopic }}</span>
            </div>

            <!-- Manual Topic Input (shown when no AI was used) -->
            <div class="topics-section" *ngIf="courseName && !step2Locked && !selectedTopic">
              <div class="topic-input-wrapper">
                <input
                  type="text"
                  class="topic-input-manual"
                  [(ngModel)]="subjectSlug"
                  (input)="onSubjectSlugChange()"
                  [placeholder]="currentLang === 'ar' ? 'Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù‚Ø³Ù…...' : 'Enter section name...'"
                  maxlength="100" />
              </div>
              <div class="field-help">
                {{ currentLang === 'ar' ? 'Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù‚Ø³Ù… ÙŠØ¯ÙˆÙŠØ§Ù‹' : 'Enter the section name manually' }}
              </div>
            </div>
          </div>

          <!-- Topic Selection Cards (shown when AI title card is selected) -->
          <div class="field-group" *ngIf="courseName && !step2Locked && courseTitleSuggestions.length > 0 && availableTopics.length > 0">
            <label class="field-label" *ngIf="!selectedTopic">
              {{ currentLang === 'ar' ? 'Ø§Ù„Ù‚Ø³Ù…' : 'Section' }}
              <span class="required">*</span>
            </label>

            <!-- Stored Topic (one line with underline) - only show when locked (after Continue) -->
            <div class="inline-field-display" *ngIf="selectedTopic && step2Locked" [dir]="isRTL ? 'rtl' : 'ltr'">
              <span class="inline-label">{{ currentLang === 'ar' ? 'Ø§Ù„Ù‚Ø³Ù…:' : 'Section:' }}</span>
              <span class="inline-value underlined">{{ selectedTopic }}</span>
            </div>

            <!-- Topic Selection Cards (shown until Continue is clicked) -->
            <div class="topics-section" *ngIf="courseName && !step2Locked && availableTopics.length > 0">
              <div class="topics-grid">
                <div
                  *ngFor="let topic of availableTopics; let i = index"
                  class="topic-card"
                  [class.selected]="selectedTopic === topic && editingTopic !== topic"
                  [class.editing]="editingTopic === topic"
                  (click)="selectTopic(topic)">
                  <div class="topic-edit-wrapper">
                    <ng-container *ngIf="editingTopic === topic; else topicDisplayStep1">
                      <input
                        type="text"
                        class="topic-input"
                        [attr.data-topic]="topic"
                        [(ngModel)]="editingTopicValue"
                        (click)="$event.stopPropagation()"
                        (keyup.enter)="saveTopicEdit()"
                        (keyup.escape)="cancelTopicEdit()"
                        [placeholder]="currentLang === 'ar' ? 'Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù‚Ø³Ù…...' : 'Enter section name...'"
                        (blur)="$event.stopPropagation()" />
                    </ng-container>
                    <ng-template #topicDisplayStep1>
                      <span class="topic-text">{{ topic }}</span>
                    </ng-template>
                    <div class="topic-edit-actions">
                      <ng-container *ngIf="editingTopic === topic; else editIconTemplate">
                        <button
                          type="button"
                          class="topic-action-btn topic-cancel-btn"
                          (click)="$event.stopPropagation(); cancelTopicEdit()"
                          [attr.aria-label]="currentLang === 'ar' ? 'Ø¥Ù„ØºØ§Ø¡' : 'Cancel'">
                          <span class="topic-action-icon">âœ•</span>
                        </button>
                        <button
                          type="button"
                          class="topic-action-btn topic-confirm-btn"
                          (click)="$event.stopPropagation(); saveTopicEdit()"
                          [attr.aria-label]="currentLang === 'ar' ? 'ØªØ£ÙƒÙŠØ¯' : 'Confirm'">
                          <span class="topic-action-icon">âœ“</span>
                        </button>
                      </ng-container>
                      <ng-template #editIconTemplate>
                        <button
                          *ngIf="selectedTopic === topic && editingTopic !== topic"
                          type="button"
                          class="topic-action-btn topic-edit-btn"
                          (click)="$event.stopPropagation(); enterTopicEdit(topic)"
                          [attr.aria-label]="currentLang === 'ar' ? 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‚Ø³Ù…' : 'Edit section'">
                          <span class="topic-action-icon">âœï¸</span>
                        </button>
                      </ng-template>
                    </div>
                  </div>
                </div>
              </div>
              <div class="field-help">
                {{ currentLang === 'ar' ? 'Ø§Ù†Ù‚Ø± Ù„Ù„Ø§Ø®ØªÙŠØ§Ø±ØŒ Ø«Ù… Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„' : 'Click to select a section, then click the edit icon to edit' }}
              </div>
            </div>
          </div>

        </div>

        <!-- Category Selection (hidden when step2Locked) -->
        <app-category-selector
          *ngIf="!selectedCategory && !step2Locked"
          [smartSix]="smartSix"
          [allCategories]="allCategories"
          [(selectedCategoryId)]="selectedCategoryId"
          (selectedCategoryIdChange)="onNgSelectChange()"
          [loading]="loading"
          [currentLang]="currentLang"
          [isRTL]="isRTL"
          (categorySelected)="selectCategory($event)">
        </app-category-selector>
      </div>

      <!-- Step 2: Course Basics -->
      <div *ngIf="showStep2" class="step-content step2-content">
        <!-- Header with Change Category Link -->
        <div class="step2-header">
          <button class="change-category-link" (click)="goBack()" *ngIf="selectedCategory">
            <span class="link-icon">â†</span>
            {{ currentLang === 'ar' ? 'ØªØºÙŠÙŠØ± Ø§Ù„ØªØµÙ†ÙŠÙ' : 'Change Category' }}
          </button>
        </div>

        <!-- Category Info - Always show if category is selected -->
        <div class="category-info-wrapper" *ngIf="selectedCategory">
          <div class="field-group category-display-group">
            <div class="inline-field-display" [dir]="isRTL ? 'rtl' : 'ltr'">
              <span class="inline-label">{{ currentLang === 'ar' ? 'Ø§Ù„ØªØµÙ†ÙŠÙ:' : 'Category:' }}</span>
              <span class="inline-icon">{{ selectedCategory.icon }}</span>
              <span class="inline-value">{{ getCategoryName(selectedCategory) }}</span>
            </div>
          </div>
        </div>

        <!-- A) Course Name -->
        <div class="field-group">
          <label class="field-label" *ngIf="!courseName">
            {{ currentLang === 'ar' ? 'Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©' : 'Course Name' }}
            <span class="required">*</span>
          </label>

          <!-- Stored Course Name (one line with underline) -->
          <div class="inline-field-display" *ngIf="courseName" [dir]="isRTL ? 'rtl' : 'ltr'">
            <span class="inline-label">{{ currentLang === 'ar' ? 'Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©:' : 'Course Name:' }}</span>
            <span class="inline-value underlined">{{ courseName }}</span>
          </div>

          <!-- AI Title Suggestions (Cards) -->
          <div class="title-cards-container" *ngIf="!courseName && courseTitleSuggestions.length > 0">
            <div class="title-cards-grid">
              <div
                *ngFor="let titleCard of courseTitleSuggestions"
                class="title-card"
                [class.selected]="courseName === titleCard.title"
                (click)="selectTitleSuggestion(titleCard)">
                <div class="title-card-header">
                  <h3 class="title-card-title">{{ titleCard.title }}</h3>
                  <div class="title-card-info" *ngIf="titleCard.rationale" title="{{ titleCard.rationale }}">
                    <span class="info-icon">â„¹ï¸</span>
                  </div>
                </div>
                <p class="title-card-rationale" *ngIf="titleCard.rationale">{{ titleCard.rationale }}</p>
              </div>
            </div>
          </div>
          
          <div class="loading-suggestions" *ngIf="loadingTitles">
            {{ currentLang === 'ar' ? 'Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª...' : 'Loading suggestions...' }}
          </div>

          <!-- Topic Selection -->
          <!-- Show topic field only if AI was not used (manual course name entry) -->
          <div class="field-group" *ngIf="courseName && courseTitleSuggestions.length === 0">
            <label class="field-label" *ngIf="!selectedTopic">
              {{ currentLang === 'ar' ? 'Ø§Ù„Ù‚Ø³Ù…' : 'Section' }}
              <span class="required">*</span>
            </label>

            <!-- Stored Topic (one line with underline) - only show when locked (after Continue) -->
            <div class="inline-field-display" *ngIf="selectedTopic && step2Locked" [dir]="isRTL ? 'rtl' : 'ltr'">
              <span class="inline-label">{{ currentLang === 'ar' ? 'Ø§Ù„Ù‚Ø³Ù…:' : 'Section:' }}</span>
              <span class="inline-value underlined">{{ selectedTopic }}</span>
            </div>

            <!-- Manual Topic Input (shown when no AI was used) -->
            <div class="topics-section" *ngIf="courseName && !step2Locked && !selectedTopic">
              <div class="topic-input-wrapper">
                <input
                  type="text"
                  class="topic-input-manual"
                  [(ngModel)]="subjectSlug"
                  (input)="onSubjectSlugChange()"
                  [placeholder]="currentLang === 'ar' ? 'Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù‚Ø³Ù…...' : 'Enter section name...'"
                  maxlength="100" />
              </div>
              <div class="field-help">
                {{ currentLang === 'ar' ? 'Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù‚Ø³Ù… ÙŠØ¯ÙˆÙŠØ§Ù‹' : 'Enter the section name manually' }}
              </div>
            </div>
          </div>

          <!-- Topic Selection Cards (shown when AI title card is selected) -->
          <div class="field-group" *ngIf="courseName && courseTitleSuggestions.length > 0 && availableTopics.length > 0">
            <label class="field-label" *ngIf="!selectedTopic">
              {{ currentLang === 'ar' ? 'Ø§Ù„Ù‚Ø³Ù…' : 'Section' }}
              <span class="required">*</span>
            </label>

            <!-- Stored Topic (one line with underline) - only show when locked (after Continue) -->
            <div class="inline-field-display" *ngIf="selectedTopic && step2Locked" [dir]="isRTL ? 'rtl' : 'ltr'">
              <span class="inline-label">{{ currentLang === 'ar' ? 'Ø§Ù„Ù‚Ø³Ù…:' : 'Section:' }}</span>
              <span class="inline-value underlined">{{ selectedTopic }}</span>
            </div>

            <!-- Topic Selection Cards (shown until Continue is clicked) -->
            <div class="topics-section" *ngIf="courseName && !step2Locked && availableTopics.length > 0">
              <div class="topics-grid">
                <div
                  *ngFor="let topic of availableTopics; let i = index"
                  class="topic-card"
                  [class.selected]="selectedTopic === topic && editingTopic !== topic"
                  [class.editing]="editingTopic === topic"
                  (click)="selectTopic(topic)">
                  <ng-container *ngIf="editingTopic === topic; else topicDisplay">
                    <input
                      type="text"
                      class="topic-input"
                      [(ngModel)]="editingTopicValue"
                      (click)="$event.stopPropagation()"
                      (keyup.enter)="saveTopicEdit()"
                      (keyup.escape)="cancelTopicEdit()"
                      [placeholder]="currentLang === 'ar' ? 'Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù‚Ø³Ù…...' : 'Enter section name...'"
                      (blur)="saveTopicEdit()" />
                  </ng-container>
                  <ng-template #topicDisplay>
                    <div class="topic-content">
                      <span class="topic-text">{{ topic }}</span>
                    </div>
                  </ng-template>
                </div>
              </div>
              <div class="field-help">
                {{ currentLang === 'ar' ? 'Ø§Ù†Ù‚Ø± Ù„Ù„Ø§Ø®ØªÙŠØ§Ø±ØŒ Ø«Ù… Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„' : 'Click to select a section, then click the edit icon to edit' }}
              </div>
            </div>
          </div>

          <!-- Fallback Topic Input (if no topics from title card) -->
          <div class="field-group" *ngIf="courseName && availableTopics.length === 0 && !selectedTopic && !editingTopic">
            <label class="field-label">
              {{ currentLang === 'ar' ? 'Ø§Ù„Ù‚Ø³Ù…' : 'Section' }}
              <span class="required">*</span>
            </label>
            <ng-select
              [(ngModel)]="subjectSlug"
              (change)="onSubjectSlugChange()"
              [items]="subjectSlugSuggestions"
              [searchable]="true"
              [clearable]="false"
              [placeholder]="currentLang === 'ar' ? 'Ø§Ø®ØªØ± Ø£Ùˆ Ø§Ø¨Ø­Ø« Ø¹Ù† ÙˆØ­Ø¯Ø©...' : 'Select or search for topic...'">
            </ng-select>
            <div class="field-help">
              {{ currentLang === 'ar' ? 'Ù…Ø«Ø§Ù„: physics, algebra, programming' : 'Example: physics, algebra, programming' }}
            </div>
          </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="wizard-actions" [dir]="isRTL ? 'rtl' : 'ltr'">

      
      <button 
        class="btn-continue" 
        [disabled]="!canContinue || savingDraftCourse"
        [attr.aria-busy]="savingDraftCourse"
        *ngIf="step2Locked"
        (click)="continue()">
        <span *ngIf="savingDraftCourse" class="btn-spinner" aria-hidden="true"></span>
        <span *ngIf="!savingDraftCourse" class="btn-icon">ğŸ¤–</span>
        <span>{{ currentLang === 'ar' ? 'Ù…ØªØ§Ø¨Ø¹Ø©' : 'Continue' }}</span>
      </button>
      
      <button 
        class="btn-continue" 
        [disabled]="!canContinue || step2Locked || savingDraftCourse"
        [attr.aria-busy]="savingDraftCourse"
        *ngIf="!step2Locked"
        (click)="continue()">
        <span *ngIf="savingDraftCourse" class="btn-spinner" aria-hidden="true"></span>
        <span *ngIf="!savingDraftCourse" class="btn-icon">ğŸ¤–</span>
        <span>{{ currentLang === 'ar' ? 'Ù…ØªØ§Ø¨Ø¹Ø©' : 'Continue' }}</span>
      </button>
    </div>

    <div class="continue-error" *ngIf="continueErrorMessage" role="alert" aria-live="assertive">
      {{ continueErrorMessage }}
    </div>

    <!-- Warning Modal -->
    <div class="modal-overlay warning-modal-overlay" *ngIf="showWarningModal" (click)="cancelGoBack()">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h3>{{ currentLang === 'ar' ? 'âš ï¸ ØªØ­Ø°ÙŠØ±' : 'âš ï¸ Warning' }}</h3>
        </div>
        <div class="modal-body">
          <p *ngIf="warningModalType === 'goBack'">{{ currentLang === 'ar' 
            ? 'Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¯Ø®Ù„Ø©. Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø§Ù„Ø¹ÙˆØ¯Ø©ØŸ Ø³ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø§Ù„Ø¨Ø¯Ø¡ Ù…Ù† Ø¬Ø¯ÙŠØ¯.' 
            : 'All entered data will be deleted. Are you sure you want to go back? You will need to start from scratch.' }}</p>
          <p *ngIf="warningModalType === 'deleteContent'">{{ currentLang === 'ar' 
            ? 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.' 
            : 'Are you sure you want to delete this content? This action cannot be undone.' }}</p>
        </div>
        <div class="modal-actions">
          <button class="btn-cancel" (click)="cancelGoBack()">
            {{ currentLang === 'ar' ? 'Ø¥Ù„ØºØ§Ø¡' : 'Cancel' }}
          </button>
          <button
            class="btn-confirm"
            [disabled]="warningModalType === 'deleteContent' ? isDeletingContent : false"
            [attr.aria-busy]="warningModalType === 'deleteContent' && isDeletingContent ? 'true' : null"
            (click)="warningModalType === 'goBack' ? confirmGoBack() : confirmDeleteContent()"
          >
            <span *ngIf="warningModalType === 'deleteContent' && isDeletingContent" class="btn-spinner" aria-hidden="true"></span>
            <span>{{ currentLang === 'ar' ? 'ØªØ£ÙƒÙŠØ¯' : 'Confirm' }}</span>
          </button>
        </div>
      </div>
    </div>

    <!-- AI Hint Modal (shown above text editor modal) -->
    <div class="modal-overlay ai-hint-overlay" *ngIf="showAIHintModal" (click)="cancelAIHint()" style="z-index: 10001;">
      <div class="modal-content ai-hint-modal" (click)="$event.stopPropagation()" style="z-index: 10001;">
        <div class="modal-header">
          <h3>{{ currentLang === 'ar' ? 'ğŸ¤– ØªÙ„Ù…ÙŠØ­ Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ' : 'ğŸ¤– AI Hint (Optional)' }}</h3>
          <button type="button" class="modal-close-btn" (click)="cancelAIHint()" [attr.aria-label]="currentLang === 'ar' ? 'Ø¥ØºÙ„Ø§Ù‚' : 'Close'">âœ•</button>
        </div>
        <div class="modal-body">
          <div class="hint-field">
            <label class="field-label">{{ currentLang === 'ar' ? 'Ø£Ø¶Ù ØªÙ„Ù…ÙŠØ­Ø§Ù‹ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)' : 'Add a hint (optional)' }}</label>
            <textarea 
              class="hint-input"
              [(ngModel)]="aiHint"
              [placeholder]="currentLang === 'ar' ? 'Ù…Ø«Ø§Ù„: Ø±ÙƒØ² Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§ØªØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø£Ù…Ø«Ù„Ø© Ø¹Ù…Ù„ÙŠØ©ØŒ Ø§Ø¬Ø¹Ù„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù…Ù†Ø§Ø³Ø¨Ø§Ù‹ Ù„Ù„Ù…Ø¨ØªØ¯Ø¦ÙŠÙ†...' : 'Example: Focus on fundamentals, use practical examples, make content suitable for beginners...'"
              [dir]="isRTL ? 'rtl' : 'ltr'"
              rows="4"
              maxlength="500"></textarea>
            <div class="field-help">
              {{ currentLang === 'ar' ? 'Ø£Ø¶Ù Ø£ÙŠ ØªÙˆØ¬ÙŠÙ‡Ø§Øª Ø£Ùˆ Ù…ØªØ·Ù„Ø¨Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„ØªØ­Ø³ÙŠÙ† Ø¬ÙˆØ¯Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…ÙˆÙ„Ù‘Ø¯' : 'Add any additional guidance or requirements to improve the quality of generated content' }}
            </div>
          </div>
          
          <div class="hint-actions">
            <button type="button" class="btn-skip" (click)="proceedWithAIGeneration(false)">
              {{ currentLang === 'ar' ? 'ØªØ¬Ø§Ù‡Ù„ ÙˆØ§Ù„Ù…ØªØ§Ø¨Ø¹Ø©' : 'Skip & Continue' }}
            </button>
            <button type="button" class="btn-continue" (click)="proceedWithAIGeneration(true)">
              {{ currentLang === 'ar' ? 'Ù…ØªØ§Ø¨Ø¹Ø© Ø¨Ø§Ù„ØªÙ„Ù…ÙŠØ­' : 'Continue with Hint' }}
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Text Editor Modal -->
    <div class="modal-overlay" *ngIf="showTextEditor">
      <div class="modal-content text-editor-modal">
        <div class="modal-header">
          <h3>{{ currentLang === 'ar' ? 'âœï¸ Ø¥Ù†Ø´Ø§Ø¡ Ø¯Ø±Ø³ Ù†ØµÙŠ' : 'âœï¸ Create Text Lesson' }}</h3>
          <button type="button" class="modal-close-btn" (click)="closeTextEditor()" [attr.aria-label]="currentLang === 'ar' ? 'Ø¥ØºÙ„Ø§Ù‚' : 'Close'">âœ•</button>
        </div>
        <div class="modal-body">
          <div class="subsection-title-field">
            <label class="field-label">{{ currentLang === 'ar' ? 'Ø§Ù„Ø¹Ù†ÙˆØ§Ù† *' : 'Title *' }}</label>
            <input 
              type="text" 
              class="subsection-title-input"
              [(ngModel)]="subsectionTitle"
              [placeholder]="currentLang === 'ar' ? 'Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†...' : 'Enter title...'"
              [dir]="isRTL ? 'rtl' : 'ltr'"
              maxlength="200">
            <div class="field-help">{{ currentLang === 'ar' ? 'Ù…Ø«Ø§Ù„: Ù…Ù‚Ø¯Ù…Ø©ØŒ Ø§Ù„Ù…ÙØ§Ù‡ÙŠÙ… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©ØŒ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ©' : 'Example: Introduction, Core Concepts, Practical Applications' }}</div>
          </div>
          
          <div class="editor-toolbar">
            <button 
              type="button"
              class="btn-generate-ai"
              [disabled]="generatingWithAI || !subsectionTitle || !subsectionTitle.trim()"
              (click)="generateTextWithAI()">
              <span class="btn-icon">ğŸ¤–</span>
              <span class="btn-text">{{ currentLang === 'ar' ? 'Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ' : 'Generate Text with AI' }}</span>
              <span class="btn-hint">{{ currentLang === 'ar' ? '(Ø³ÙˆÙ ÙŠØ³ØªØºØ±Ù‚ Ø¯Ù‚ÙŠÙ‚Ø©)' : '(Will take a minute)' }}</span>
            </button>
            <div class="ai-generating" *ngIf="generatingWithAI">
              <span class="spinner"></span>
              <span>{{ currentLang === 'ar' ? 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­...' : 'Suggesting...' }}</span>
            </div>
          </div>
          
          <div class="editor-container" [attr.dir]="isRTL ? 'rtl' : 'ltr'">
            <ckeditor 
              [editor]="Editor"
              [config]="editorConfig"
              [(ngModel)]="textContent"
              (ready)="onReady($event)">
            </ckeditor>
          </div>
          
          <div class="editor-actions">
            <button type="button" class="btn-cancel" (click)="cancelTextEditor()">
              {{ currentLang === 'ar' ? 'Ø¥Ù„ØºØ§Ø¡' : 'Cancel' }}
            </button>
            <button
              type="button"
              class="btn-save"
              [disabled]="generatingWithAI || !subsectionTitle.trim() || savingTextContent || isEditorUploading"
              (click)="saveTextContent()">
              <span *ngIf="!savingTextContent">{{ currentLang === 'ar' ? 'Ø­ÙØ¸' : 'Save' }}</span>
              <span *ngIf="savingTextContent" class="btn-save-content">
                <span class="inline-spinner" aria-hidden="true"></span>
                <span>{{ currentLang === 'ar' ? 'Ø¬Ø§Ø±Ù Ø§Ù„Ø­ÙØ¸...' : 'Saving...' }}</span>
              </span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Content Type Creation Modal (AI-assisted or Manual) -->
    <div class="modal-overlay" *ngIf="showContentTypeModal" (click)="closeContentTypeModal()">
      <div class="modal-content content-type-modal" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h3>{{ getContentTypeModalTitle() }}</h3>
          <button type="button" class="modal-close-btn" (click)="closeContentTypeModal()" [attr.aria-label]="currentLang === 'ar' ? 'Ø¥ØºÙ„Ø§Ù‚' : 'Close'">âœ•</button>
        </div>
        <div class="modal-body">
          <p class="modal-description">{{ getContentTypeModalDescription() }}</p>
          <div class="creation-options">
            <button 
              type="button"
              class="creation-option-btn ai-option"
              (click)="selectCreationMode('ai')">
              <span class="option-icon">ğŸ¤–</span>
              <span class="option-label">{{ currentLang === 'ar' ? 'Ù…Ø³Ø§Ø¹Ø¯ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ' : 'AI-assisted' }}</span>
              <span class="option-desc">{{ currentLang === 'ar' ? 'Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹' : 'Use AI to automatically generate content' }}</span>
            </button>
            
            <button 
              type="button"
              class="creation-option-btn manual-option"
              (click)="selectCreationMode('manual')">
              <span class="option-icon">âœï¸</span>
              <span class="option-label">{{ currentLang === 'ar' ? 'ÙŠØ¯ÙˆÙŠ' : 'Manual' }}</span>
              <span class="option-desc">{{ currentLang === 'ar' ? 'Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¨Ù†ÙØ³Ùƒ Ø®Ø·ÙˆØ© Ø¨Ø®Ø·ÙˆØ©' : 'Create content yourself step by step' }}</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Resource Creation Modal -->
    <div class="modal-overlay" *ngIf="showResourceModal" (click)="closeResourceModal()">
      <div class="modal-content resource-modal" (click)="$event.stopPropagation()" [dir]="isRTL ? 'rtl' : 'ltr'">
        <div class="modal-header">
          <h3>{{ currentLang === 'ar' ? 'ğŸ“„ Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ù' : 'ğŸ“„ Add Resource' }}</h3>
          <button type="button" class="modal-close-btn" (click)="closeResourceModal()" [attr.aria-label]="currentLang === 'ar' ? 'Ø¥ØºÙ„Ø§Ù‚' : 'Close'">âœ•</button>
        </div>
        <div class="modal-body">
          <div class="field-group">
            <label class="field-label" for="resourceTitle">{{ currentLang === 'ar' ? 'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù„Ù *' : 'Resource Title *' }}</label>
            <input
              id="resourceTitle"
              type="text"
              class="field-input"
              [(ngModel)]="resourceForm.title"
              [placeholder]="currentLang === 'ar' ? 'Ù…Ø«Ø§Ù„: Ø£ÙˆØ±Ø§Ù‚ Ø¹Ù…Ù„ Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰' : 'Example: Unit 1 Worksheets'"
              [dir]="isRTL ? 'rtl' : 'ltr'"
              maxlength="150" />
          </div>

          <div class="field-group">
            <label class="field-label" for="resourceType">{{ currentLang === 'ar' ? 'Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù' : 'File Type' }}</label>
            <select id="resourceType" class="field-select" [(ngModel)]="resourceForm.displayType">
              <option *ngFor="let option of resourceTypeOptions" [value]="option.value">
                {{ currentLang === 'ar' ? option.icon + ' ' + option.labelAr : option.icon + ' ' + option.labelEn }}
              </option>
            </select>
            <div class="field-help">{{ currentLang === 'ar' ? 'Ø§Ù„ØµÙŠØº Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡Ø§: ZIP, RAR, PDF, PPT/PPTXØŒ XLS/XLSXØŒ DOC/DOCX.' : 'Allowed formats: ZIP, RAR, PDF, PPT/PPTX, XLS/XLSX, DOC/DOCX.' }}</div>
          </div>

          <div class="field-group">
            <label class="field-label" for="resourceFile">{{ currentLang === 'ar' ? 'ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù *' : 'Upload File *' }}</label>
            <input id="resourceFile" type="file" class="field-input" (change)="onResourceFileSelected($event)" />
            <div class="field-error" *ngIf="resourceUploadError">{{ resourceUploadError }}</div>
            <div class="resource-uploading" *ngIf="resourceUploading">
              <span class="resource-uploading-spinner"></span>
              <span>{{ currentLang === 'ar' ? 'Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„Ù...' : 'Processing file...' }}</span>
            </div>
            <div class="resource-file-summary" *ngIf="resourceForm.fileName">
               <span class="resource-summary-icon">{{ getResourceIcon({ kind: resourceForm.displayType, fileName: resourceForm.fileName, fileType: resourceForm.fileType, fileSize: resourceForm.fileSize }) }}</span>
               <div class="resource-summary-details">
                 <span class="resource-summary-name">{{ getResourceDisplayLabelFromForm() }}</span>
                 <span class="resource-summary-meta">
                   <ng-container *ngFor="let entry of getResourceDetailEntriesFromForm(); let last = last">
                     <span class="resource-detail"><strong>{{ entry.label }}:</strong> {{ entry.value }}</span><span *ngIf="!last">{{ getResourceDetailSeparator() }}</span>
                   </ng-container>
                 </span>
               </div>
             </div>
          </div>

          <div class="field-group">
            <label class="field-label" for="resourceDescription">{{ currentLang === 'ar' ? 'Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø­ÙˆÙ„ Ø§Ù„Ù…Ù„Ù' : 'Resource Notes' }}</label>
            <textarea
              id="resourceDescription"
              rows="4"
              class="field-textarea"
              [(ngModel)]="resourceForm.description"
              [placeholder]="currentLang === 'ar' ? 'Ø£Ø¶Ù ÙˆØµÙØ§Ù‹ Ù‚ØµÙŠØ±Ø§Ù‹ Ø£Ùˆ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ù„Ù„Ù…Ù„Ù...' : 'Add a short description or instructions for the resource...'"
              [dir]="isRTL ? 'rtl' : 'ltr'"
              maxlength="600"></textarea>
            <div class="field-help">{{ currentLang === 'ar' ? 'Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø§Øª ØªØ³Ø§Ø¹Ø¯ Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¹Ù„Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ù„Ù Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.' : 'Add notes that help students use this resource effectively.' }}</div>
          </div>

          <div class="resource-preview-container" *ngIf="resourceForm.previewMode === 'inline' && resourceForm.dataUrl">
            <div class="resource-preview-header">
              <span class="preview-label">{{ currentLang === 'ar' ? 'Ù…Ø¹Ø§ÙŠÙ†Ø© Ø³Ø±ÙŠØ¹Ø©' : 'Quick Preview' }}</span>
              <span class="preview-hint">{{ currentLang === 'ar' ? 'Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ù„Ù„Ø§Ø·Ù„Ø§Ø¹ ÙÙ‚Ø·.' : 'Preview for reference only.' }}</span>
            </div>
            <div class="resource-preview-frame" *ngIf="resourceForm.displayType === 'pdf'">
              <iframe [src]="resourcePreviewSafeUrl" title="Resource preview" loading="lazy"></iframe>
            </div>
          </div>

          <div class="resource-preview-placeholder" *ngIf="resourceForm.previewMode === 'download' && resourceForm.fileName">
            {{ currentLang === 'ar' ? 'Ù„Ù† ÙŠØªÙ… Ø¹Ø±Ø¶ Ù…Ø¹Ø§ÙŠÙ†Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù. Ø³ÙŠÙƒÙˆÙ† Ù…ØªØ§Ø­Ø§Ù‹ Ù„Ù„ØªÙ†Ø²ÙŠÙ„.' : 'Preview is not available for this file. It will be provided as a download.' }}
          </div>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn-cancel" (click)="closeResourceModal()" [disabled]="resourceUploadInProgress || resourceSaving">
            {{ currentLang === 'ar' ? 'Ø¥Ù„ØºØ§Ø¡' : 'Cancel' }}
          </button>
          <button type="button" class="btn-save" (click)="submitResource()" [disabled]="resourceSaving || resourceUploading || resourceUploadInProgress || !resourceForm.title.trim() || !resourceFile">
            {{ currentLang === 'ar' ? 'Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù' : 'Save Resource' }}
          </button>
        </div>
        <div class="resource-upload-overlay" *ngIf="resourceUploadInProgress">
          <div class="resource-upload-dialog">
            <div class="upload-spinner"></div>
            <div class="upload-progress-info">
              <span class="upload-text">{{ currentLang === 'ar' ? 'Ø¬Ø§Ø±ÙŠ Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù...' : 'Uploading resource...' }}</span>
              <div class="upload-progress-bar">
                <div class="upload-progress-fill" [style.width.%]="resourceUploadProgress"></div>
              </div>
              <span class="upload-progress-value">{{ resourceUploadProgress }}%</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Video Content Modal -->
    <div class="modal-overlay" *ngIf="showVideoModal" (click)="closeVideoModal()">
      <div class="modal-content video-modal" (click)="$event.stopPropagation()" [dir]="isRTL ? 'rtl' : 'ltr'">
        <div class="modal-header">
          <div class="modal-header-left">
            <!-- Back button for form modes -->
            <button 
              *ngIf="!viewingVideoContent && videoForm.source"
              type="button" 
              class="btn-back-header"
              (click)="resetVideoSource()">
              <span class="back-arrow">{{ currentLang === 'ar' ? 'â†’' : 'â†' }}</span>
            </button>
            <h3>{{ viewingVideoContent ? (currentLang === 'ar' ? 'ğŸ¥ Ø¹Ø±Ø¶ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ' : 'ğŸ¥ View Video') : (currentLang === 'ar' ? 'ğŸ¥ Ø¥Ø¶Ø§ÙØ© ÙÙŠØ¯ÙŠÙˆ' : 'ğŸ¥ Add Video') }}</h3>
            
            <!-- Delete button for view mode -->
            <button 
              *ngIf="viewingVideoContent && videoContentItem"
              type="button" 
              class="btn-delete-header"
              (click)="deleteVideoContent()"
              [disabled]="deletingVideo"
              [attr.aria-label]="currentLang === 'ar' ? 'Ø­Ø°Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ' : 'Delete Video'">
              <span *ngIf="!deletingVideo">ğŸ—‘ï¸</span>
              <span *ngIf="deletingVideo">â³</span>
            </button>
          </div>
          <button type="button" class="modal-close-btn" (click)="closeVideoModal()" [attr.aria-label]="currentLang === 'ar' ? 'Ø¥ØºÙ„Ø§Ù‚' : 'Close'">âœ•</button>
        </div>
        
        <div class="modal-body">
          <!-- View/Delete Mode -->
          <div *ngIf="viewingVideoContent && videoContentItem" class="video-view-mode">
            <div class="video-info">
              <h4 class="video-title">{{ videoContentItem.title }}</h4>
              <p class="video-description" *ngIf="videoContentItem.meta && videoContentItem.meta['description']">{{ videoContentItem.meta['description'] }}</p>
              <div class="video-metadata">
                <span class="video-duration" *ngIf="videoContentItem.meta && videoContentItem.meta['durationFormatted']">
                  <span class="meta-label">{{ currentLang === 'ar' ? 'Ø§Ù„Ù…Ø¯Ø©:' : 'Duration:' }}</span>
                  <span class="meta-value">{{ videoContentItem.meta['durationFormatted'] }}</span>
                </span>
                <span class="video-source">
                  <span class="meta-label">{{ currentLang === 'ar' ? 'Ø§Ù„Ù…ØµØ¯Ø±:' : 'Source:' }}</span>
                  <span class="meta-value">{{ videoContentItem.meta && videoContentItem.meta['source'] === 'youtube' ? 'YouTube' : (currentLang === 'ar' ? 'Ù…Ù„Ù Ù…Ø­Ù„ÙŠ' : 'Local File') }}</span>
                </span>
              </div>
            </div>
            
            <!-- Video Preview -->
            <div class="video-preview-container">
              <!-- YouTube Video -->
              <iframe 
                *ngIf="videoContentItem.meta && videoContentItem.meta['source'] === 'youtube' && videoContentItem.meta['youtubeEmbedUrl']"
                [src]="getYouTubeSafeUrl(videoContentItem.meta['youtubeEmbedUrl'])"
                class="video-iframe"
                frameborder="0"
                allowfullscreen
                loading="lazy">
              </iframe>
              
              <!-- Local Video -->
              <video 
                *ngIf="videoContentItem.meta && videoContentItem.meta['source'] === 'local' && videoContentItem.meta['dataUrl']"
                [src]="videoContentItem.meta['dataUrl']"
                class="video-player"
                controls
                preload="metadata">
              </video>
            </div>
            
          </div>
          
          <!-- Add/Edit Mode -->
          <div *ngIf="!viewingVideoContent" class="video-add-mode">
            <!-- Source Selection -->
            <div class="video-source-selection" *ngIf="!videoForm.source">
              <div class="selection-header">
                <div class="source-icon">ğŸ¥</div>
                <h3 class="source-prompt">{{ currentLang === 'ar' ? 'Ø§Ø®ØªØ± Ù…ØµØ¯Ø± Ø§Ù„ÙÙŠØ¯ÙŠÙˆ' : 'Choose Video Source' }}</h3>
                <p class="source-subtitle">{{ currentLang === 'ar' ? 'Ø­Ø¯Ø¯ ÙƒÙŠÙ ØªØ±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ' : 'Select how you want to add your video content' }}</p>
              </div>
              
              <div class="source-options">
                <button 
                  type="button" 
                  class="source-option-btn"
                  (click)="selectVideoSource('local')">
                  <div class="option-icon-wrapper">
                    <span class="option-icon">ğŸ“¤</span>
                  </div>
                  <div class="option-content">
                    <span class="option-label">{{ currentLang === 'ar' ? 'Ø±ÙØ¹ Ù…Ù„Ù ÙÙŠØ¯ÙŠÙˆ' : 'Upload Video File' }}</span>
                    <span class="option-desc">{{ currentLang === 'ar' ? 'MP4 Ø£Ùˆ AVI â€¢ Ø­ØªÙ‰ 100 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª' : 'MP4 or AVI â€¢ Up to 100 MB' }}</span>
                  </div>
                  <span class="option-arrow">â†’</span>
                </button>
                
                <button 
                  type="button" 
                  class="source-option-btn"
                  (click)="selectVideoSource('youtube')">
                  <div class="option-icon-wrapper">
                    <span class="option-icon">ğŸ”—</span>
                  </div>
                  <div class="option-content">
                    <span class="option-label">{{ currentLang === 'ar' ? 'ÙÙŠØ¯ÙŠÙˆ ÙŠÙˆØªÙŠÙˆØ¨' : 'YouTube Video' }}</span>
                    <span class="option-desc">{{ currentLang === 'ar' ? 'Ø£Ø¶Ù Ø±Ø§Ø¨Ø· ÙÙŠØ¯ÙŠÙˆ Ù…Ù† ÙŠÙˆØªÙŠÙˆØ¨' : 'Add a video link from YouTube' }}</span>
                  </div>
                  <span class="option-arrow">â†’</span>
                </button>
              </div>
            </div>
            
            <!-- Local Upload Form -->
            <div *ngIf="videoForm.source === 'local'" class="video-upload-form">
              <div class="form-section">
                
                <div class="file-upload-area" *ngIf="!videoForm.file">
                  <input 
                    type="file" 
                    #videoFileInput
                    accept=".mp4,.avi,video/mp4,video/x-msvideo"
                    (change)="onVideoFileSelected($event)"
                    class="file-input-hidden">
                  <button 
                    type="button"
                    class="upload-trigger-btn"
                    (click)="videoFileInput.click()">
                    <span class="upload-icon">ğŸ“¹</span>
                    <span class="upload-text">{{ currentLang === 'ar' ? 'Ø§Ø®ØªØ± Ù…Ù„Ù ÙÙŠØ¯ÙŠÙˆ' : 'Choose Video File' }}</span>
                    <span class="upload-hint">{{ currentLang === 'ar' ? 'MP4 Ø£Ùˆ AVI (Ø­ØªÙ‰ 100 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª)' : 'MP4 or AVI (up to 100 MB)' }}</span>
                  </button>
                </div>
                
                <div *ngIf="videoForm.file" class="selected-file-info">
                  <div class="file-details">
                    <span class="file-icon">ğŸ¥</span>
                    <div class="file-meta">
                      <span class="file-name">{{ videoForm.fileName }}</span>
                      <span class="file-size">{{ formatFileSize(videoForm.fileSize || 0) }}</span>
                      <span class="file-duration" *ngIf="videoForm.metadata?.durationFormatted">
                        {{ currentLang === 'ar' ? 'Ø§Ù„Ù…Ø¯Ø©:' : 'Duration:' }} {{ videoForm.metadata?.durationFormatted }}
                      </span>
                    </div>
                    <button 
                      type="button"
                      class="remove-file-btn"
                      (click)="removeVideoFile()">
                      âœ•
                    </button>
                  </div>
                </div>
                
                <div class="form-fields" *ngIf="videoForm.file">
                  <div class="form-group">
                    <label>{{ currentLang === 'ar' ? 'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ' : 'Video Title' }} *</label>
                    <input 
                      type="text"
                      [(ngModel)]="videoForm.title"
                      [placeholder]="currentLang === 'ar' ? 'Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ' : 'Enter video title'"
                      maxlength="200"
                      required>
                  </div>
                  
                  <div class="form-group">
                    <label>{{ currentLang === 'ar' ? 'ÙˆØµÙ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ' : 'Video Description' }}</label>
                    <textarea 
                      [(ngModel)]="videoForm.description"
                      [placeholder]="currentLang === 'ar' ? 'Ø£Ø¯Ø®Ù„ ÙˆØµÙ Ù…Ø®ØªØµØ± Ù„Ù„ÙÙŠØ¯ÙŠÙˆ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)' : 'Enter a brief description (optional)'"
                      rows="3"
                      maxlength="500">
                    </textarea>
                  </div>
                </div>
                
                <div class="upload-error" *ngIf="videoUploadError">
                  <span class="error-icon">âš ï¸</span>
                  <span class="error-text">{{ videoUploadError }}</span>
                </div>
                
                <div class="upload-progress" *ngIf="videoUploadInProgress">
                  <div class="progress-bar">
                    <div class="progress-fill" [style.width.%]="videoUploadProgress"></div>
                  </div>
                  <span class="progress-text">{{ currentLang === 'ar' ? 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±ÙØ¹...' : 'Uploading...' }} {{ videoUploadProgress }}%</span>
                </div>
              </div>
            </div>
            
            <!-- YouTube Link Form -->
            <div *ngIf="videoForm.source === 'youtube'" class="youtube-link-form">
              <div class="form-section">
                <div class="form-group">
                  <label>{{ currentLang === 'ar' ? 'Ø±Ø§Ø¨Ø· ÙÙŠØ¯ÙŠÙˆ ÙŠÙˆØªÙŠÙˆØ¨' : 'YouTube Video URL' }} *</label>
                  <input 
                    type="url"
                    [(ngModel)]="videoForm.youtubeUrl"
                    (blur)="validateYouTubeUrl()"
                    [placeholder]="currentLang === 'ar' ? 'https://www.youtube.com/watch?v=...' : 'https://www.youtube.com/watch?v=...'"
                    required>
                </div>
                
                <div class="form-actions-row">
                  <button 
                    type="button"
                    class="btn-fetch"
                    (click)="fetchYouTubeMetadata()"
                    [disabled]="!videoForm.youtubeUrl || fetchingYouTubeData">
                    <span *ngIf="!fetchingYouTubeData">{{ currentLang === 'ar' ? 'Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª' : 'Fetch Info' }}</span>
                    <span *ngIf="fetchingYouTubeData">{{ currentLang === 'ar' ? 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¬Ù„Ø¨...' : 'â³ Fetching...' }}</span>
                  </button>
                </div>
                
                <div class="youtube-preview" *ngIf="videoForm.youtubeData">
                  <div class="youtube-thumbnail">
                    <img [src]="videoForm.youtubeData.thumbnail" [alt]="videoForm.youtubeData.title">
                  </div>
                  <div class="youtube-info">
                    <h5>{{ videoForm.youtubeData.title }}</h5>
                    <p>{{ videoForm.youtubeData.description | slice:0:200 }}{{ videoForm.youtubeData.description.length > 200 ? '...' : '' }}</p>
                    <span class="youtube-duration">
                      {{ currentLang === 'ar' ? 'Ø§Ù„Ù…Ø¯Ø©:' : 'Duration:' }} {{ formatDuration(videoForm.youtubeData.duration) }}
                    </span>
                  </div>
                </div>
                
                <div class="form-fields" *ngIf="videoForm.youtubeData">
                  <div class="form-group">
                    <label>{{ currentLang === 'ar' ? 'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ' : 'Video Title' }} *</label>
                    <input 
                      type="text"
                      [(ngModel)]="videoForm.title"
                      [placeholder]="currentLang === 'ar' ? 'Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ' : 'Enter video title'"
                      maxlength="200"
                      required>
                  </div>
                  
                  <div class="form-group">
                    <label>{{ currentLang === 'ar' ? 'ÙˆØµÙ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ' : 'Video Description' }}</label>
                    <textarea 
                      [(ngModel)]="videoForm.description"
                      [placeholder]="currentLang === 'ar' ? 'Ø£Ø¯Ø®Ù„ ÙˆØµÙ Ù…Ø®ØªØµØ± Ù„Ù„ÙÙŠØ¯ÙŠÙˆ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)' : 'Enter a brief description (optional)'"
                      rows="3"
                      maxlength="500">
                    </textarea>
                  </div>
                </div>
                
                <div class="youtube-error" *ngIf="youtubeError">
                  <span class="error-icon">âš ï¸</span>
                  <span class="error-text">{{ youtubeError }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Modal Actions -->
        <div class="modal-actions" *ngIf="!viewingVideoContent && videoForm.source && (videoForm.file || videoForm.youtubeData)">
          <button 
            type="button" 
            class="btn-cancel"
            (click)="closeVideoModal()"
            [disabled]="savingVideo || videoUploadInProgress">
            {{ currentLang === 'ar' ? 'Ø¥Ù„ØºØ§Ø¡' : 'Cancel' }}
          </button>
          <button 
            type="button" 
            class="btn-primary"
            (click)="saveVideoContent()"
            [disabled]="!canSaveVideo() || savingVideo || videoUploadInProgress">
            <span *ngIf="!savingVideo">{{ currentLang === 'ar' ? 'Ø­ÙØ¸ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ' : 'Save Video' }}</span>
            <span *ngIf="savingVideo">{{ currentLang === 'ar' ? 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...' : 'â³ Saving...' }}</span>
          </button>
        </div>
        
        <!-- Video Upload Progress Overlay -->
        <div class="video-upload-overlay" *ngIf="videoUploadInProgress">
          <div class="video-upload-dialog">
            <div class="upload-spinner"></div>
            <div class="upload-progress-info">
              <span class="upload-text">{{ currentLang === 'ar' ? 'Ø¬Ø§Ø±ÙŠ Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ...' : 'Uploading video...' }}</span>
              <div class="upload-progress-bar">
                <div class="upload-progress-fill" [style.width.%]="videoUploadProgress"></div>
              </div>
              <span class="upload-progress-value">{{ videoUploadProgress }}%</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Resource Preview Modal -->
    <div class="modal-overlay" *ngIf="showResourcePreviewModal" (click)="closeResourcePreview()">
      <div class="modal-content resource-preview-modal" (click)="$event.stopPropagation()" [dir]="isRTL ? 'rtl' : 'ltr'">
        <div class="modal-header">
          <h3>{{ currentLang === 'ar' ? 'Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù' : 'View Resource' }}</h3>
          <button type="button" class="modal-close-btn" (click)="closeResourcePreview()" [attr.aria-label]="currentLang === 'ar' ? 'Ø¥ØºÙ„Ø§Ù‚' : 'Close'">âœ•</button>
        </div>
        <div class="modal-body" *ngIf="resourcePreviewItem">
          <div class="resource-preview-info">
            <div class="resource-preview-icon">{{ getResourceIcon(resourcePreviewItem.resourceDetails) }}</div>
            <div class="resource-preview-details">
              <span class="resource-preview-title">{{ resourcePreviewItem.title }}</span>
              <span class="resource-preview-meta">
                <ng-container *ngFor="let entry of getResourceDetailEntries(resourcePreviewItem.resourceDetails); let last = last">
                  <span class="resource-detail"><strong>{{ entry.label }}:</strong> {{ entry.value }}</span><span *ngIf="!last">{{ getResourceDetailSeparator() }}</span>
                </ng-container>
              </span>
              <span class="resource-preview-date">{{ (resourcePreviewItem.updatedAt || resourcePreviewItem.createdAt) | date:'medium' }}</span>
            </div>
          </div>

          <p class="resource-preview-description" *ngIf="resourcePreviewItem.resourceDetails?.description">{{ resourcePreviewItem.resourceDetails?.description }}</p>

          <div class="resource-preview-frame" *ngIf="resourcePreviewItem.resourceDetails?.previewMode === 'inline' && resourcePreviewSafeUrl && resourcePreviewKind === 'pdf'">
            <iframe [src]="resourcePreviewSafeUrl" title="PDF preview" loading="lazy"></iframe>
          </div>

          <div class="resource-preview-placeholder" *ngIf="resourcePreviewItem.resourceDetails?.previewMode !== 'inline'">
            {{ currentLang === 'ar' ? 'Ù„Ø§ ØªØªÙˆÙØ± Ù…Ø¹Ø§ÙŠÙ†Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù. ÙŠÙ…ÙƒÙ†Ùƒ ØªÙ†Ø²ÙŠÙ„Ù‡ Ù„Ø¹Ø±Ø¶Ù‡.' : 'Preview not available for this file. Download to view it.' }}
          </div>
        </div>
        <div class="modal-actions">
          <ng-container *ngIf="resourcePreviewItem?.resourceDetails as previewDetails">
            <a
              *ngIf="previewDetails.dataUrl"
              class="btn-primary"
              [href]="previewDetails.dataUrl"
              [attr.download]="getResourceDownloadName(previewDetails)">
              {{ currentLang === 'ar' ? 'ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ù„Ù' : 'Download File' }}
            </a>
          </ng-container>
          <button type="button" class="btn-cancel" (click)="closeResourcePreview()">
            {{ currentLang === 'ar' ? 'Ø¥ØºÙ„Ø§Ù‚' : 'Close' }}
          </button>
        </div>
      </div>
    </div>
    </div>
  </div>

  <!-- Info Preview -->
  <div class="info-preview" *ngIf="selectedCategory">
    <h3>{{ currentLang === 'ar' ? 'Ø®Ø·ÙˆØ§Øª Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©:' : 'Course Building Steps:' }}</h3>
    <div class="preview-grid">
      <div class="preview-item">
        <span class="preview-icon">ğŸ“</span>
        <span class="preview-title">{{ currentLang === 'ar' ? 'Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø£Ø³Ø§Ø³ÙŠØ§Øª Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©' : 'Step 1: Course Basics' }}</span>
        <span class="preview-desc">{{ currentLang === 'ar' ? 'Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© ÙˆØ§Ù„ÙˆØ­Ø¯Ø©' : 'Name and topic' }}</span>
      </div>
      <div class="preview-item">
        <span class="preview-icon">ğŸ¯</span>
        <span class="preview-title">{{ currentLang === 'ar' ? 'Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø§Ù‚Ø³Ø§Ù…' : 'Step 2: Building Sections' }}</span>
        <span class="preview-desc">{{ currentLang === 'ar' ? 'Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø§Ù‚Ø³Ø§Ù… ÙˆØ§Ù„Ø£Ù‚Ø³Ø§Ù…' : 'Build units and sections' }}</span>
      </div>
      <div class="preview-item">
        <span class="preview-icon">ğŸš€</span>
        <span class="preview-title">{{ currentLang === 'ar' ? 'Ø§Ù„Ø®Ø·ÙˆØ© 3: Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆÙ†Ø´Ø±' : 'Step 3: Review & Publish' }}</span>
        <span class="preview-desc">{{ currentLang === 'ar' ? 'ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø±Ø¤ÙŠØ© ÙˆØ§Ù„Ù†Ø´Ø± Ù…Ø¹ Ù‚Ø³Ù… Ø§Ø®ØªÙŠØ§Ø±ÙŠ' : 'Set visibility and publish with optional section' }}</span>
      </div>
    </div>
  </div>
</div>

<!-- Delete Section Confirmation Modal -->
<div class="modal-overlay" *ngIf="showDeleteSectionModal" (click)="cancelDeleteSection()">
  <div class="modal-content delete-section-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2 class="modal-title">{{ currentLang === 'ar' ? 'Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù…ØŸ' : 'Delete this section?' }}</h2>
      <button type="button" class="modal-close" (click)="cancelDeleteSection()">âœ•</button>
    </div>
    <div class="modal-body">
      <p class="delete-message">{{ currentLang === 'ar' ? 'Ø³ÙŠØªÙ… Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… ÙˆØ¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª Ø¨Ø¯Ø§Ø®Ù„Ù‡ Ø¨Ø´ÙƒÙ„ Ù†Ù‡Ø§Ø¦ÙŠ.' : 'This will permanently delete the section and everything inside it.' }}</p>
      <p class="delete-warning">{{ currentLang === 'ar' ? 'Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡. ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© delete Ù„Ù„ØªØ£ÙƒÙŠØ¯.' : 'This action cannot be undone. Please type delete to confirm.' }}</p>
      <p class="delete-section-name" *ngIf="sectionToDelete">{{ sectionToDelete.name }}</p>
      <div class="delete-confirm-field" *ngIf="sectionToDelete?.content_items?.length">
        <label for="delete-confirm-input">{{ currentLang === 'ar' ? 'Ø§ÙƒØªØ¨ delete Ù„Ù„ØªØ£ÙƒÙŠØ¯' : 'Type delete to confirm' }}</label>
        <input
          id="delete-confirm-input"
          type="text"
          [(ngModel)]="deleteConfirmationInput"
          (keydown.enter)="canConfirmDeleteSection() ? confirmDeleteSection() : null"
          [attr.placeholder]="deleteKeyword"
          autocomplete="off"
        />
      </div>
    </div>
    <div class="modal-actions">
      <button type="button" class="btn-cancel" (click)="cancelDeleteSection()">
        {{ currentLang === 'ar' ? 'Ø¥Ù„ØºØ§Ø¡' : 'Cancel' }}
      </button>
      <button type="button" class="btn-delete" (click)="confirmDeleteSection()" [disabled]="sectionRequiresConfirmation() && !canConfirmDeleteSection()">
        {{ currentLang === 'ar' ? 'Ù†Ø¹Ù…ØŒ Ø­Ø°Ù' : 'Yes, delete' }}
      </button>
    </div>
  </div>
</div>

<!-- Start from Scratch Modal -->
<div class="modal-overlay" *ngIf="showStartFromScratchModal" (click)="showStartFromScratchModal = false">
  <div class="modal-content start-from-scratch-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2 class="modal-title">{{ currentLang === 'ar' ? 'Ø¨Ø¯Ø¡ Ù…Ù† Ø¬Ø¯ÙŠØ¯' : 'Start from Scratch' }}</h2>
      <button type="button" class="modal-close" (click)="showStartFromScratchModal = false">âœ•</button>
    </div>
    <div class="modal-body">
      <p class="warning-message">{{ currentLang === 'ar' ? 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø­Ø°Ù ÙƒÙ„ Ø´ÙŠØ¡ ÙˆØ§Ù„Ø¨Ø¯Ø¡ Ù…Ù† Ø¬Ø¯ÙŠØ¯ØŸ' : 'Are you sure you want to delete everything and start from scratch?' }}</p>
      <p class="warning-details">{{ currentLang === 'ar' ? 'Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Ø§Ù„Ù…Ø§Ø¯Ø©ØŒ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…ØŒ ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰. Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.' : 'All saved data will be deleted including course, sections, and content. This action cannot be undone.' }}</p>
    </div>
    <div class="modal-actions">
      <button type="button" class="btn-cancel" (click)="showStartFromScratchModal = false">
        {{ currentLang === 'ar' ? 'Ø¥Ù„ØºØ§Ø¡' : 'Cancel' }}
      </button>
      <button 
        type="button" 
        class="btn-delete" 
        (click)="confirmStartFromScratch()"
        [disabled]="deletingDraftCourse"
        [attr.aria-busy]="deletingDraftCourse">
        <span *ngIf="deletingDraftCourse" class="btn-spinner" aria-hidden="true"></span>
        <span>{{ currentLang === 'ar' ? 'Ù†Ø¹Ù…ØŒ Ø§Ø¨Ø¯Ø£ Ù…Ù† Ø¬Ø¯ÙŠØ¯' : 'Yes, Start from Scratch' }}</span>
      </button>
    </div>
  </div>
</div>

<!-- Undo Toast (shown after section deletion) -->
<div class="undo-toast" *ngIf="showUndoToast" [class.show]="showUndoToast" [dir]="isRTL ? 'rtl' : 'ltr'">
  <div class="toast-content">
    <span class="toast-message">{{ currentLang === 'ar' ? 'ØªÙ… Ø§Ù„Ø­Ø°Ù' : 'Section deleted' }}</span>
    <button type="button" class="btn-undo" (click)="undoDeleteSection()">
      {{ currentLang === 'ar' ? 'ØªØ±Ø§Ø¬Ø¹' : 'Undo' }}
    </button>
  </div>
</div>

<!-- Delete Cover Confirmation Modal -->
<div class="modal-overlay" *ngIf="showDeleteCoverModal" (click)="showDeleteCoverModal = false">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>{{ deleteCoverTitle }}</h3>
      <button type="button" class="modal-close-btn" (click)="showDeleteCoverModal = false" [attr.aria-label]="currentLang === 'ar' ? 'Ø¥ØºÙ„Ø§Ù‚' : 'Close'">âœ•</button>
    </div>
    <div class="modal-body">
      <p>{{ deleteCoverMessage }}</p>
    </div>
    <div class="modal-actions">
      <button class="btn-cancel" (click)="showDeleteCoverModal = false" [disabled]="courseCoverUploading">
        {{ currentLang === 'ar' ? 'ØªØ±Ø§Ø¬Ø¹' : 'Cancel' }}
      </button>
      <button class="btn-confirm" (click)="confirmDeleteCover()" [disabled]="courseCoverUploading">
        <span *ngIf="!courseCoverUploading">{{ currentLang === 'ar' ? 'Ø­Ø°Ù' : 'Delete' }}</span>
        <span *ngIf="courseCoverUploading" class="btn-loading">
          <span class="spinner"></span>
          <span>{{ currentLang === 'ar' ? 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­Ø°Ù...' : 'Deleting...' }}</span>
        </span>
      </button>
    </div>
  </div>
</div>

<!-- Audio Content Modal -->
<div class="modal-overlay" *ngIf="showAudioModal" (click)="closeAudioModal()">
  <div class="modal-content audio-modal" (click)="$event.stopPropagation()" [dir]="isRTL ? 'rtl' : 'ltr'">
    <div class="modal-header">
      <div class="modal-header-left">
        <!-- Back button for form modes -->
        <button 
          *ngIf="!viewingAudioContent && audioForm.source"
          type="button" 
          class="btn-back-header"
          (click)="resetAudioSource()">
          <span class="back-arrow">{{ currentLang === 'ar' ? 'â†’' : 'â†' }}</span>
        </button>
        <h3>{{ viewingAudioContent ? (currentLang === 'ar' ? 'ğŸµ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ' : 'ğŸµ View Audio') : (currentLang === 'ar' ? 'ğŸµ Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ù ØµÙˆØªÙŠ' : 'ğŸµ Add Audio') }}</h3>
        
        <!-- Edit button for view mode -->
        <button 
          *ngIf="viewingAudioContent && audioContentItem"
          type="button" 
          class="btn-edit-header"
          (click)="editAudioContent()"
          [attr.aria-label]="currentLang === 'ar' ? 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ' : 'Edit Audio'">
          âœï¸
        </button>
        
        <!-- Delete button for view mode -->
        <button 
          *ngIf="viewingAudioContent && audioContentItem"
          type="button" 
          class="btn-delete-header"
          (click)="deleteAudioContent()"
          [disabled]="deletingAudio"
          [attr.aria-label]="currentLang === 'ar' ? 'Ø­Ø°Ù Ø§Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ' : 'Delete Audio'">
          <span *ngIf="!deletingAudio">ğŸ—‘ï¸</span>
          <span *ngIf="deletingAudio">â³</span>
        </button>
      </div>
      <button type="button" class="modal-close-btn" (click)="closeAudioModal()" [attr.aria-label]="currentLang === 'ar' ? 'Ø¥ØºÙ„Ø§Ù‚' : 'Close'">âœ•</button>
    </div>
    
    <div class="modal-body">
      <!-- View Mode -->
      <div *ngIf="viewingAudioContent && audioContentItem" class="audio-view-mode">
        <div class="audio-info">
          <h4 class="audio-title">{{ audioContentItem.title }}</h4>
          <p class="audio-description" *ngIf="audioContentItem.meta && audioContentItem.meta['description']">{{ audioContentItem.meta['description'] }}</p>
          <div class="audio-metadata">
            <span class="audio-duration" *ngIf="audioContentItem.meta && audioContentItem.meta['durationFormatted']">
              <span class="meta-label">{{ currentLang === 'ar' ? 'Ø§Ù„Ù…Ø¯Ø©:' : 'Duration:' }}</span>
              {{ audioContentItem.meta['durationFormatted'] }}
            </span>
            <span class="audio-size" *ngIf="audioContentItem.meta && audioContentItem.meta['fileSize']">
              <span class="meta-label">{{ currentLang === 'ar' ? 'Ø§Ù„Ø­Ø¬Ù…:' : 'Size:' }}</span>
              {{ formatFileSize(+audioContentItem.meta['fileSize']) }}
            </span>
            <span class="audio-source" *ngIf="audioContentItem.meta && audioContentItem.meta['provider']">
              <span class="meta-label">{{ currentLang === 'ar' ? 'Ø§Ù„Ù…ØµØ¯Ø±:' : 'Source:' }}</span>
              {{ audioContentItem.meta['provider'] === 'upload' ? (currentLang === 'ar' ? 'Ø±ÙØ¹ Ù…Ù„Ù' : 'File Upload') : 
                 audioContentItem.meta['provider'] === 'convert' ? (currentLang === 'ar' ? 'ØªØ­ÙˆÙŠÙ„ Ù†Øµ' : 'Text Conversion') :
                 audioContentItem.meta['provider'] === 'generate' ? (currentLang === 'ar' ? 'ØªÙˆÙ„ÙŠØ¯ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ' : 'AI Generated') : 
                 audioContentItem.meta['provider'] }}
            </span>
          </div>
        </div>
        
        <div class="audio-player-container">
          <audio 
            *ngIf="audioContentItem.meta && audioContentItem.meta['dataUrl']"
            [src]="audioContentItem.meta['dataUrl']"
            class="audio-player"
            controls
            preload="metadata">
          </audio>
        </div>
      </div>
      
      <!-- Add/Edit Mode -->
      <div *ngIf="!viewingAudioContent" class="audio-add-mode">
        <!-- Source Selection -->
        <div class="audio-source-selection" *ngIf="!audioForm.source">
          <div class="selection-header">
            <div class="source-icon">ğŸµ</div>
            <h3 class="source-prompt">{{ currentLang === 'ar' ? 'Ø§Ø®ØªØ± Ù…ØµØ¯Ø± Ø§Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ' : 'Choose Audio Source' }}</h3>
            <p class="source-subtitle">{{ currentLang === 'ar' ? 'Ø­Ø¯Ø¯ ÙƒÙŠÙ ØªØ±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØµÙˆØªÙŠ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ' : 'Select how you want to add your audio content' }}</p>
          </div>
          
          <div class="source-options">
            <button 
              type="button" 
              class="source-option-btn"
              (click)="selectAudioSource('upload')">
              <div class="option-icon-wrapper">
                <span class="option-icon">ğŸ“¤</span>
              </div>
              <h4 class="option-title">{{ currentLang === 'ar' ? 'Ø±ÙØ¹ Ù…Ù„Ù ØµÙˆØªÙŠ' : 'Upload Audio File' }}</h4>
              <p class="option-description">{{ currentLang === 'ar' ? 'Ø§Ø±ÙØ¹ Ù…Ù„Ù ØµÙˆØªÙŠ Ù…Ù† Ø¬Ù‡Ø§Ø²Ùƒ (MP3, WAV, M4A, OGG)' : 'Upload an audio file from your device (MP3, WAV, M4A, OGG)' }}</p>
            </button>
            
            <button 
              type="button" 
              class="source-option-btn"
              (click)="selectAudioSource('convert')">
              <div class="option-icon-wrapper">
                <span class="option-icon">ğŸ”„</span>
              </div>
              <h4 class="option-title">{{ currentLang === 'ar' ? 'ØªØ­ÙˆÙŠÙ„ Ø¯Ø±Ø³ Ù†ØµÙŠ' : 'Convert Text Lesson' }}</h4>
              <p class="option-description">{{ currentLang === 'ar' ? 'Ø§Ø®ØªØ± Ø¯Ø±Ø³Ø§Ù‹ Ù†ØµÙŠØ§Ù‹ Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹ ÙˆØ­ÙˆÙ„Ù‡ Ø¥Ù„Ù‰ ØµÙˆØª' : 'Select an existing text lesson and convert it to audio' }}</p>
            </button>
            
            <button 
              type="button" 
              class="source-option-btn"
              (click)="selectAudioSource('generate')">
              <div class="option-icon-wrapper">
                <span class="option-icon">ğŸ¤–</span>
              </div>
              <h4 class="option-title">{{ currentLang === 'ar' ? 'ØªÙˆÙ„ÙŠØ¯ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ' : 'AI Generate Audio' }}</h4>
              <p class="option-description">{{ currentLang === 'ar' ? 'Ø§ÙƒØªØ¨ Ù†ØµØ§Ù‹ ÙˆØ§ØªØ±ÙƒÙ‡ Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„ÙŠØ­ÙˆÙ„Ù‡ Ø¥Ù„Ù‰ ØµÙˆØª' : 'Write text and let AI convert it to natural speech' }}</p>
            </button>
          </div>
        </div>
        
        <!-- Upload Audio Form -->
        <div *ngIf="audioForm.source === 'upload'" class="audio-upload-form">
          <h3 class="form-section-title">
            <span>ğŸ“¤</span>
            {{ currentLang === 'ar' ? 'Ø±ÙØ¹ Ù…Ù„Ù ØµÙˆØªÙŠ' : 'Upload Audio File' }}
          </h3>
          
          <!-- Show existing audio player when editing -->
          <div *ngIf="audioForm.existingUrl && !audioForm.file" class="existing-audio-preview">
            <p class="preview-label">{{ currentLang === 'ar' ? 'Ø§Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ:' : 'Current Audio:' }}</p>
            <audio 
              [src]="audioForm.existingUrl"
              controls
              preload="metadata"
              class="existing-audio-player">
            </audio>
            <p class="preview-hint">{{ currentLang === 'ar' ? 'Ø§Ø±ÙØ¹ Ù…Ù„ÙØ§Ù‹ Ø¬Ø¯ÙŠØ¯Ø§Ù‹ Ù„Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù' : 'Upload a new file to replace this audio' }}</p>
          </div>
          
          <div class="file-upload-area" 
               (click)="audioFileInput.click()"
               (dragover)="$event.preventDefault(); $event.currentTarget.classList.add('dragover')"
               (dragleave)="$event.currentTarget.classList.remove('dragover')"
               (drop)="$event.preventDefault(); $event.currentTarget.classList.remove('dragover'); onAudioFileSelected($event)">
            <div class="upload-icon">ğŸµ</div>
            <p class="upload-text">{{ currentLang === 'ar' ? 'Ø§Ø¶ØºØ· Ù„Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø£Ùˆ Ø§Ø³Ø­Ø¨Ù‡ Ù‡Ù†Ø§' : 'Click to select file or drag it here' }}</p>
            <p class="upload-hint">{{ currentLang === 'ar' ? 'MP3, WAV, M4A, OGG - Ø­ØªÙ‰ 50 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª' : 'MP3, WAV, M4A, OGG - Up to 50 MB' }}</p>
            <input #audioFileInput type="file" class="file-input" accept=".mp3,.wav,.m4a,.ogg,audio/*" (change)="onAudioFileSelected($event)">
          </div>
          
          <div *ngIf="audioForm.file" class="selected-file-info">
            <div class="file-details">
              <span class="file-icon">ğŸµ</span>
              <div class="file-info">
                <p class="file-name">{{ audioForm.fileName }}</p>
                <p class="file-meta">
                  {{ formatFileSize(audioForm.fileSize) }}
                  <span *ngIf="audioForm.metadata?.durationFormatted"> â€¢ {{ audioForm.metadata?.durationFormatted }}</span>
                </p>
              </div>
              <button type="button" class="remove-file-btn" (click)="audioForm.file = null; audioForm.fileName = ''; audioForm.fileSize = 0; audioForm.metadata = null">
                âœ•
              </button>
            </div>
          </div>
          
          <div class="form-fields">
            <div class="form-group">
              <label>{{ currentLang === 'ar' ? 'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ' : 'Audio Title' }}</label>
              <input 
                type="text" 
                [(ngModel)]="audioForm.title"
                [placeholder]="currentLang === 'ar' ? 'Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ' : 'Enter audio title'"
                maxlength="200"
                required>
            </div>
            
            <div class="form-group">
              <label>{{ currentLang === 'ar' ? 'ÙˆØµÙ Ø§Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ' : 'Audio Description' }}</label>
              <textarea 
                [(ngModel)]="audioForm.description"
                [placeholder]="currentLang === 'ar' ? 'Ø£Ø¯Ø®Ù„ ÙˆØµÙ Ù…Ø®ØªØµØ± Ù„Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)' : 'Enter a brief description (optional)'"
                rows="3"
                maxlength="500">
              </textarea>
            </div>
          </div>
          
          <div class="upload-error" *ngIf="audioUploadError">
            <span class="error-icon">âš ï¸</span>
            <span class="error-text">{{ audioUploadError }}</span>
          </div>
          
          <div class="form-actions">
            <button type="button" class="btn-cancel" (click)="resetAudioSource()">
              {{ currentLang === 'ar' ? 'Ø¥Ù„ØºØ§Ø¡' : 'Cancel' }}
            </button>
            <button 
              type="button" 
              class="btn-primary"
              (click)="saveAudioContent()"
              [disabled]="!canSaveAudio() || savingAudio || audioUploadInProgress">
              <span *ngIf="savingAudio" class="btn-spinner"></span>
              <span *ngIf="!savingAudio">{{ currentLang === 'ar' ? 'Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ' : 'Save Audio' }}</span>
              <span *ngIf="savingAudio">{{ currentLang === 'ar' ? 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...' : 'â³ Saving...' }}</span>
            </button>
          </div>
        </div>
        
        <!-- Convert Text Lesson Form -->
        <div *ngIf="audioForm.source === 'convert'" class="text-lesson-selection">
          <h3 class="form-section-title">
            <span>ğŸ”„</span>
            {{ currentLang === 'ar' ? 'ØªØ­ÙˆÙŠÙ„ Ø¯Ø±Ø³ Ù†ØµÙŠ Ø¥Ù„Ù‰ ØµÙˆØª' : 'Convert Text Lesson to Audio' }}
          </h3>
          
          <div class="lesson-list">
            <div *ngIf="getTextLessons().length === 0" class="no-lessons">
              {{ currentLang === 'ar' ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯Ø±ÙˆØ³ Ù†ØµÙŠØ© Ù…ØªØ§Ø­Ø© Ù„Ù„ØªØ­ÙˆÙŠÙ„' : 'No text lessons available for conversion' }}
            </div>
            <div *ngFor="let lesson of getTextLessons()" 
                 class="lesson-item"
                 [class.selected]="audioForm.selectedTextLessonId === lesson.id"
                 (click)="selectTextLesson(lesson)">
              <h4 class="lesson-title">{{ lesson.title }}</h4>
              <p class="lesson-preview" *ngIf="lesson.body_html">{{ lesson.body_html | slice:0:150 }}...</p>
            </div>
          </div>
          
          <div *ngIf="audioForm.selectedTextLesson" class="voice-settings">
            <div class="form-group">
              <label>{{ currentLang === 'ar' ? 'Ø§Ù„ØµÙˆØª' : 'Voice' }}</label>
              <select [(ngModel)]="audioForm.voice">
                <option *ngFor="let voice of ttsVoices" [value]="voice.value">
                  {{ currentLang === 'ar' ? voice.labelAr : voice.labelEn }}
                </option>
              </select>
            </div>
            
            <div class="form-group">
              <label>{{ currentLang === 'ar' ? 'Ø³Ø±Ø¹Ø© Ø§Ù„ÙƒÙ„Ø§Ù…' : 'Speech Speed' }}</label>
              <input type="range" [(ngModel)]="audioForm.speed" min="0.5" max="2.0" step="0.1">
              <span>{{ audioForm.speed }}x</span>
            </div>
          </div>
          
          <div class="form-fields">
            <div class="form-group">
              <label>{{ currentLang === 'ar' ? 'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ' : 'Audio Title' }}</label>
              <input 
                type="text" 
                [(ngModel)]="audioForm.title"
                [placeholder]="currentLang === 'ar' ? 'Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ' : 'Enter audio title'"
                maxlength="200"
                required>
            </div>
            
            <div class="form-group">
              <label>{{ currentLang === 'ar' ? 'ÙˆØµÙ Ø§Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ' : 'Audio Description' }}</label>
              <textarea 
                [(ngModel)]="audioForm.description"
                [placeholder]="currentLang === 'ar' ? 'Ø£Ø¯Ø®Ù„ ÙˆØµÙ Ù…Ø®ØªØµØ± Ù„Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)' : 'Enter a brief description (optional)'"
                rows="3"
                maxlength="500">
              </textarea>
            </div>
          </div>
          
          <div class="form-actions">
            <button type="button" class="btn-cancel" (click)="resetAudioSource()">
              {{ currentLang === 'ar' ? 'Ø¥Ù„ØºØ§Ø¡' : 'Cancel' }}
            </button>
            <button 
              type="button" 
              class="btn-primary"
              (click)="saveAudioContent()"
              [disabled]="!canSaveAudio() || savingAudio || generatingAudio">
              <span *ngIf="generatingAudio" class="btn-spinner"></span>
              <span *ngIf="!generatingAudio">{{ currentLang === 'ar' ? 'ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ ØµÙˆØª' : 'Convert to Audio' }}</span>
              <span *ngIf="generatingAudio">{{ currentLang === 'ar' ? 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„...' : 'â³ Converting...' }}</span>
            </button>
          </div>
        </div>
        
        <!-- Generate Audio Form -->
        <div *ngIf="audioForm.source === 'generate'" class="text-generation-form">
          <h3 class="form-section-title">
            <span>ğŸ¤–</span>
            {{ currentLang === 'ar' ? 'ØªÙˆÙ„ÙŠØ¯ ØµÙˆØª Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ' : 'AI Generate Audio' }}
          </h3>
          
          <div class="text-input-area">
            <label>{{ currentLang === 'ar' ? 'Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø±Ø§Ø¯ ØªØ­ÙˆÙŠÙ„Ù‡ Ø¥Ù„Ù‰ ØµÙˆØª' : 'Text to Convert to Speech' }}</label>
            <textarea 
              [(ngModel)]="audioForm.textContent"
              [placeholder]="currentLang === 'ar' ? 'Ø§ÙƒØªØ¨ Ø§Ù„Ù†Øµ Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ ØªØ­ÙˆÙŠÙ„Ù‡ Ø¥Ù„Ù‰ ØµÙˆØª...' : 'Write the text you want to convert to speech...'"
              rows="6"
              maxlength="4000">
            </textarea>
          </div>
          
          <div class="voice-settings">
            <div class="form-group">
              <label>{{ currentLang === 'ar' ? 'Ø§Ù„ØµÙˆØª' : 'Voice' }}</label>
              <select [(ngModel)]="audioForm.voice">
                <option *ngFor="let voice of ttsVoices" [value]="voice.value">
                  {{ currentLang === 'ar' ? voice.labelAr : voice.labelEn }}
                </option>
              </select>
            </div>
            
            <div class="form-group">
              <label>{{ currentLang === 'ar' ? 'Ø³Ø±Ø¹Ø© Ø§Ù„ÙƒÙ„Ø§Ù…' : 'Speech Speed' }}</label>
              <input type="range" [(ngModel)]="audioForm.speed" min="0.5" max="2.0" step="0.1">
              <span>{{ audioForm.speed }}x</span>
            </div>
          </div>
          
          <div class="form-fields">
            <div class="form-group">
              <label>{{ currentLang === 'ar' ? 'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ' : 'Audio Title' }}</label>
              <input 
                type="text" 
                [(ngModel)]="audioForm.title"
                [placeholder]="currentLang === 'ar' ? 'Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ' : 'Enter audio title'"
                maxlength="200"
                required>
            </div>
            
            <div class="form-group">
              <label>{{ currentLang === 'ar' ? 'ÙˆØµÙ Ø§Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ' : 'Audio Description' }}</label>
              <textarea 
                [(ngModel)]="audioForm.description"
                [placeholder]="currentLang === 'ar' ? 'Ø£Ø¯Ø®Ù„ ÙˆØµÙ Ù…Ø®ØªØµØ± Ù„Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)' : 'Enter a brief description (optional)'"
                rows="3"
                maxlength="500">
              </textarea>
            </div>
          </div>
          
          <div class="form-actions">
            <button type="button" class="btn-cancel" (click)="resetAudioSource()">
              {{ currentLang === 'ar' ? 'Ø¥Ù„ØºØ§Ø¡' : 'Cancel' }}
            </button>
            <button 
              type="button" 
              class="btn-primary"
              (click)="saveAudioContent()"
              [disabled]="!canSaveAudio() || savingAudio || generatingAudio">
              <span *ngIf="generatingAudio" class="btn-spinner"></span>
              <span *ngIf="!generatingAudio">{{ currentLang === 'ar' ? 'ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØµÙˆØª' : 'Generate Audio' }}</span>
              <span *ngIf="generatingAudio">{{ currentLang === 'ar' ? 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆÙ„ÙŠØ¯...' : 'â³ Generating...' }}</span>
            </button>
          </div>
        </div>
      </div>
      
      <!-- Audio Upload Progress Overlay -->
      <div class="audio-upload-overlay" *ngIf="audioUploadInProgress || generatingAudio">
        <div class="audio-upload-dialog">
          <div class="upload-spinner"></div>
          <div class="upload-progress-info">
            <span class="upload-text">
              {{ audioUploadInProgress ? 
                (currentLang === 'ar' ? 'Ø¬Ø§Ø±ÙŠ Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù Ø§Ù„ØµÙˆØªÙŠ...' : 'Uploading audio file...') :
                (currentLang === 'ar' ? 'Ø¬Ø§Ø±ÙŠ ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØµÙˆØª...' : 'Generating audio...') }}
            </span>
            <div class="upload-progress-bar" *ngIf="audioUploadInProgress">
              <div class="upload-progress-fill" [style.width.%]="audioUploadProgress"></div>
            </div>
            <span class="upload-progress-value" *ngIf="audioUploadInProgress">{{ audioUploadProgress }}%</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
