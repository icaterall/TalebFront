<!doctype html>
<html>
  <head>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>ANATALEB</title>

    <!-- Minimal critical CSS & preinit state -->
    <style>
      /* Keep background stable and app hidden until we’re truly ready */
      html.preinit, html.preinit body { background:#fff; }
      html.preinit app-root { visibility:hidden }
      #preloader { position:fixed; inset:0; display:flex; align-items:center; justify-content:center;
                   background:#fff; z-index:9999; font:600 14px system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif }
      #preloader.hide { display:none }
    </style>

    <!-- Set lang/dir BEFORE any render -->
    <script>
      (function () {
        try {
          document.documentElement.classList.add('preinit');
          var saved = sessionStorage.getItem('anataleb.lang');
          var lang = (saved === 'en' || saved === 'ar') ? saved : 'ar';
          var dir  = (lang === 'ar') ? 'rtl' : 'ltr';
          var el   = document.documentElement;
          el.setAttribute('lang', lang);
          el.setAttribute('dir',  dir);
          window.__ANATALEB_STARTUP_LANG__ = lang; // used in app.config.ts
        } catch(e) {}
      })();
    </script>

    <!-- PRELOAD correct production asset paths (not /src/...) -->
  <link rel="preload" href="assets/fonts/hkgrotesk-regular.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="assets/fonts/hkgrotesk-bold.woff2"    as="font" type="font/woff2" crossorigin>
  </head>
  <body>
    <!-- Tiny branded preloader -->
    <div id="preloader">
      <span>Please wait…</span>
    </div>

    <app-root></app-root>

    <!-- Reveal app when Angular + i18n + fonts are ready -->
    <script>
      window.addEventListener('AnatalebReady', function(){
        var reveal = function () {
          document.documentElement.classList.remove('preinit');
          var p = document.getElementById('preloader'); if (p) p.classList.add('hide');
        };
        if (document.fonts && document.fonts.ready) {
          document.fonts.ready.then(reveal).catch(reveal);
        } else { reveal(); }
      });
    </script>
  </body>
</html>
